!function(f,E,K){"use strict";var Y="ht",S=f[Y],H=S.Default,D=S.graph,o=H.getInternal(),i=o.ui(),F=i.NodeUI.prototype,h=i.ShapeUI.prototype,g=D.GraphView,R=g.prototype,L=i.EdgeUI.prototype,k=S.Node,s=S.Shape,T=S.Edge,A=S.Group,d=H.isTouchable,W=H.preventDefault,O=f.setTimeout,$=H.grow,B=H.isDragging,b=H.getDistance,n=null,u=S.List,v="undefined"!=typeof Float32Array?Float32Array:Array,t=Math,C=t.PI,m="Crossing",U="No Crossing",j=C/2,w=2*C,X=t.atan2,P=t.sqrt,z=t.pow,l=t.sin,G=t.cos,Z=t.min,Q=t.max,J=t.abs,q=t.ceil,r=t.round,y=H.unionPoint,e=H.unionRect,M=H.containsPoint,a=H.clone,p="rgb(52, 152, 219)",x="red",V={northwest:0,north:1,northeast:2,west:7,east:3,southwest:6,south:5,southeast:4},I={width:400,height:100,comps:[{type:"shape",points:{func:function(){for(var e=[10,8,162,36,314,37,269,2,398,49,268,98,314,58,161,60,9,91,103,49,10,8],t=0;t<e.length;t++){var m=e[t];m=0===t%2?m/400*I.width:m/100*I.height,e[t]=m}return I.width>120&&(e[4]=I.width-26,e[6]=I.width-40,e[10]=I.width-40,e[12]=I.width-26,e[18]=33),e}},segments:[1,3,2,2,2,2,3,2,2],background:"white",gradient:"linear.east",gradientColor:"red"}]},c={width:300,height:300,comps:[{type:"circle",rect:[20,0,120,120],background:p,rotation:.61},{type:"circle",rect:[200,120,70,70],background:p,rotation:.61},{type:"circle",rect:[200,220,70,70],background:p,rotation:.61},{type:"shape",points:[80,60,80,155,200,155],borderWidth:20,borderColor:p},{type:"shape",points:[80,60,80,255,200,255],borderWidth:20,borderColor:p}]},N={width:300,height:300,comps:[{type:"shape",points:[114,239,115,106,112,73,149,73,149,73,175,73,177,105,179,261,178,302,147,307,98,308,83,307,72,276,73,260,72,81,74,29,115,21,191,21,221,22,224,53,223,238],segments:[1,2,3,2,3,2,3,2,4,2,3,2,3,2],borderWidth:20,borderColor:x,rotation:.61}]},_={width:300,height:300,comps:[{type:"circle",rect:[210,0,90,90],background:p},{type:"circle",rect:[0,210,90,90],background:p},{type:"shape",points:[255,45,45,255],borderWidth:20,borderColor:p}]},zc={width:300,height:300,comps:[{type:"shape",points:[20,20,280,280],borderWidth:30,borderColor:x},{type:"shape",points:[280,20,20,280],borderWidth:30,borderColor:x}]},Dg={width:300,height:300,comps:[{type:"shape",points:[270,30,30,150,270,270],borderWidth:40,borderColor:p}]},ic={width:300,height:300,comps:[{type:"shape",points:[30,30,270,150,30,270],borderWidth:40,borderColor:x}]},Gh={width:300,height:300,comps:[{type:"rect",rect:[125.58,52.76,40,231.96],background:"rgb(0,0,0)",borderWidth:1,borderColor:"#000"},{type:"rect",rect:[27.87,61.06,150,30],background:"rgb(0,0,0)",borderWidth:1,borderColor:"#000",rotation:5.5},{type:"rect",rect:[113.36,61,150,30],background:"rgb(0,0,0)",borderWidth:1,borderColor:"#000",rotation:.79}]},pf={width:300,height:300,author:"",note:"",comps:[{type:"rect",rect:[135.15,38.76,28.63,82.84],background:"rgb(0,0,0)",borderWidth:1,borderColor:"#000"},{type:"triangle",rect:[94.69,2.35,110,44.77],background:"rgb(0,0,0)",borderWidth:1,borderColor:"#000"},{type:"rect",rect:[31.71,115.72,240,15],background:"rgb(0,0,0)",borderWidth:1,borderColor:"#000"},{type:"rect",rect:[31.71,167.62,240,15],background:"rgb(0,0,0)",borderWidth:1,borderColor:"#000"},{type:"rect",rect:[135.15,177.33,28.63,82.84],background:"rgb(0,0,0)",borderWidth:1,borderColor:"#000"},{type:"triangle",rect:[94.69,251.39,110,44.77],background:"rgb(0,0,0)",borderWidth:1,borderColor:"#000",rotation:3.14}]},Bj=function(t){var F=t.touches[0];return F?F:t.changedTouches[0]},xi=function(K,Q,D,v){return X(v-Q,D-K)},Ei=function(q,S){return{x:q.x*S,y:q.y*S}},tk=function(z,D){z.each(function(c){return z.isSelected(c)?D(c):void 0})},sn=function(N,P){N.reverseEach(function(M){return N.isSelected(M)?P(M):void 0})},Qq=function(t,j,l){var n,A,a,e,R,S=this,p=j,N=S.gv;if(t instanceof s){a=t.getSegments();var F=N.getDataUI(t);R=F._55O.$15l,a&&a.size()||(a=gm(R)),t.isClosePath()&&a.indexOf(5)<0&&(a=new u(a._as),a.add(5)),n=se(t,F,p),A=R[n]}else{var q=N.getDataUI(t);R=hn(q,t.s("edge.points")),a=t.s("edge.segments"),a&&a.size()||(a=gm(R)),R=R._as,n=se(t,q,p),A=R[n]}if(a&&(e=a.get(p)),2===e||1===e||5===e){var Y=R[n+1];5===e&&(Y=R[0]);var L=Be(A,l,Y);return L}return l},Ir=function(r,$,t,W){var u=$/2,T=t/2,c=ns(r,-u,-T,W),S=ns(r,u,-T,W),v=ns(r,-u,T,W),k=ns(r,u,T,W),f=ns(r,0,-T,W),C=ns(r,u,0,W),F=ns(r,0,T,W),Y=ns(r,-u,0,W);return[c,S,v,k,f,C,F,Y]},Be=function(W,o,J){var s={x:o.x-W.x,y:o.y-W.y},D={x:J.x-W.x,y:J.y-W.y},l=P(z(J.x-W.x,2)+z(J.y-W.y,2)),g={x:D.x/l,y:D.y/l},q=s.x*g.x+s.y*g.y,K={x:g.x*q,y:g.y*q};return{x:W.x+K.x,y:W.y+K.y}},ns=function(R,c,i,m){var Z=G(m)*c-l(m)*i,d=l(m)*c+G(m)*i;return R?{x:R.x+Z,y:R.y+d}:{x:Z,y:d}},Fp=function(w,T){return T>2*w?w:T/2},tf=function(s,j,B,N){var h=b(s,j);return B=N?Z(B,h):Fp(B,h),h?B/=h:B=0,{x:s.x+(j.x-s.x)*B,y:s.y+(j.y-s.y)*B}},rp=function(N,g){var W,f,t=N.gv,$=N._data,T=$._40I,d=$._41I,X=$.s("edge.offset"),z=$.s("edge.source.position"),D=$.s("edge.target.position"),R=$.s("edge.source.offset.x"),k=$.s("edge.source.offset.y"),n=$.s("edge.target.offset.x"),m=$.s("edge.target.offset.y"),e=$.s("edge.source.anchor.x"),j=$.s("edge.source.anchor.y"),I=$.s("edge.target.anchor.x"),E=$.s("edge.target.anchor.y");if(g?(W=o.getEdgeAgentPosition(t,T,z,R,k,e,j),f=o.getEdgeAgentPosition(t,d,D,n,m,I,E)):(W=o.getEdgeAgentPosition(t,T,z,0,0,e,j),f=o.getEdgeAgentPosition(t,d,D,0,0,I,E)),"points"===$.s("edge.type")&&X&&!$.s("edge.center")&&W){var P=$.s("edge.points")||new u,q=P.size(),s=tf(W,q?P.get(0):f,X,q),i=tf(f,q?P.get(q-1):W,X,q);W=s,f=i}return[W,f]},hn=function(d,f,Y){var I=d._78o,N=d._data,c=N.s("edge.type"),p=[I.sourcePoint,I.targetPoint];return"points"===c?Y&&(p=rp(d)):p=I.center?c?Y?rp(d):rp(d,!0):Y?rp(d):[I.c1,I.c2]:Y?rp(d):rp(d,!0),f=new u(f?f._as:n),f.add(p[0],0),f.add(p[1]),f},ds=function(J){return J=new u(J._as),J.removeAt(0),J.removeAt(J.size()-1),J},gm=function(x){x._as||(x=new u(x));var n=new u;n.add(1);for(var l=1;l<x.size();l++)n.add(2);return n},Sf=function(n,T){return{x:(n.x+T.x)/2,y:(n.y+T.y)/2}},Od=function(k,Y){return{x:k.x+1*(Y.x-k.x)/4,y:k.y+1*(Y.y-k.y)/4}},gc=function(X,g){return{x:X.x+3*(g.x-X.x)/4,y:X.y+3*(g.y-X.y)/4}},El=function(S,a,W,N){var Q=a.x+a.width/2,q=a.y+a.height/2,L=P(Q*Q+q*q),F=X(q,Q)+W;return{x:N.x+L*G(F),y:N.y+L*l(F)}},il=R.validateImpl,bh=R.isRectEditable,cq=R.isPointEditable,jf=R._42,nk=h._79o,fd=L._79o,rl=h._48O,nm=h._47O,bd=F._48O,go=F._80o,xb=h._80o,$f=F.getSelectWidth,Fh=F._47O,Lj=L._47O,kc=R.isEditable,Mf=["northwest","north","northeast","east","southeast","south","southwest","west"],Tq=function(h,X,U,T,H,s,j,Q,D,v){var F=h.x,i=h.y,Y=h.width,o=h.height,t={x:F+Y/2,y:i+o/2};T=T||0,X=ns(t,X.x-t.x,X.y-t.y,-T),j&&!Q&&(X.x+=D,X.y+=v);var x=.01;if("northwest"===U?(X.x+H>F+Y-x&&(X.x=F+Y-H-x),X.y+H>i+o-x&&(X.y=i+o-H-x),h=y(X,{x:F+Y,y:i+o})):"north"===U?(X.y+H>i+o-x&&(X.y=i+o-H-x),h=y({x:F,y:X.y},{x:F+Y,y:i+o})):"northeast"===U?(X.x<F+H+x&&(X.x=F+H+x),X.y+H>i+o-x&&(X.y=i+o-H-x),h=y({x:F,y:X.y},{x:X.x,y:i+o})):"west"===U?(X.x+H>F+Y-x&&(X.x=F+Y-H-x),h=y({x:X.x,y:i},{x:F+Y,y:i+o})):"east"===U?(X.x<F+H+x&&(X.x=F+H+x),h=y({x:F,y:i},{x:X.x,y:i+o})):"southwest"===U?(X.x+H>F+Y-x&&(X.x=F+Y-H-x),X.y<i+H+x&&(X.y=i+H+x),h=y({x:X.x,y:i},{x:F+Y,y:X.y})):"south"===U?(X.y<i+H+x&&(X.y=i+H+x),h=y({x:F,y:i},{x:F+Y,y:X.y})):"southeast"===U&&(X.x<F+H+x&&(X.x=F+H+x),X.y<i+H+x&&(X.y=i+H+x),h=y({x:F,y:i},X)),"keepRatio"===s&&(!j&&Q||j&&!Q)&&("northeast"===U||"southeast"===U||"northwest"===U||"southwest"===U)){var w=h.width,f=h.height,N=w/Y,J=f/o,k=Z(N,J);h.width=Y*k,h.height=o*k,"northeast"===U?h.y=i+(o-h.height):"northwest"===U?(h.y=i+(o-h.height),h.x=F+(Y-h.width)):"southwest"===U&&(h.x=F+(Y-h.width))}h.x-=t.x,h.y-=t.y;var _=El(n,h,T,t);return h.x=_.x-h.width/2,h.y=_.y-h.height/2,h},iq=function(X,K,k,T){var w=X.getRotation(),g=K,t=g.x,N=g.y,x=g.width,P=g.height,Y={x:t+g.width/2,y:N+g.height/2};T=ns(Y,T.x-Y.x,T.y-Y.y,-w),"northwest"===k?g=y(T,{x:t+x,y:N+P}):"north"===k?g=y({x:t,y:T.y},{x:t+x,y:N+P}):"northeast"===k?g=y({x:t,y:T.y},{x:T.x,y:N+P}):"west"===k?g=y({x:T.x,y:N},{x:t+x,y:N+P}):"east"===k?g=y({x:t,y:N},{x:T.x,y:N+P}):"southwest"===k?g=y({x:T.x,y:N},{x:t+x,y:T.y}):"south"===k?g=y({x:t,y:N},{x:t+x,y:T.y}):"southeast"===k&&(g=y({x:t,y:N},T)),X.setRect(g),g.x-=Y.x,g.y-=Y.y;var b=El(X,g,w,Y);X.p(b.x,b.y)},ug=function(Y,$,C,c,E,H,S,D){var O=n;H?(O=ns(n,E.x-$.x,E.y-$.y,-C),O.x-=S.x,O.y-=S.y):O=ns(n,E.x-$.x,E.y-$.y,0);var u={x:$.x+O.x,y:$.y+O.y};D&&(u=D(u.x,u.y)),u.e=Y.getPoints().get(c).e,Y.setPoint(c,u);var L=Y.getWidth(),o=Y.getHeight(),k=Y.p().x-L/2,p=Y.p().y-o/2;k-=$.x,p-=$.y;var J=El(Y,{x:k,y:p,width:L,height:o},C,$);Y.p(J.x,J.y)},se=function(B,V,H){var X,y;if(B instanceof s?(X=B.getPoints(),y=B.getSegments()):B instanceof T&&"points"===B.s("edge.type")&&(X=B.s("edge.points"),y=B.s("edge.segments"),X=hn(V,X)),y&&y.size()||(y=gm(X)),B instanceof s&&B.isClosePath()&&y.indexOf(5)<0&&(y=new u(y._as),y.add(5)),y)for(var v=-1,t=0;t<y.size();t++){if(t===H)return v;var $=y.get(t);1===$?v+=1:2===$?v+=1:3===$?v+=2:4===$&&(v+=3)}},Qe=function(N,Q,x){var u,K;if(N instanceof s?(u=N.getPoints(),K=N.getSegments()):N instanceof T&&"points"===N.s("edge.type")&&(u=N.s("edge.points"),K=N.s("edge.segments"),u=hn(Q,u)),K&&K.size()||(K=gm(u)),K)for(var J=-1,U=0;U<K.size();U++){var D=K.get(U);if(1===D?J+=1:2===D?J+=1:3===D?J+=2:4===D&&(J+=3),J===x)return U}},dk=function(Y,X){var T=[Y[0]-X[0],Y[1]-X[1],Y[2]-X[2]];return T},Qb=function(){var Q=new v(16);return Q[0]=1,Q[1]=0,Q[2]=0,Q[3]=0,Q[4]=0,Q[5]=1,Q[6]=0,Q[7]=0,Q[8]=0,Q[9]=0,Q[10]=1,Q[11]=0,Q[12]=0,Q[13]=0,Q[14]=0,Q[15]=1,Q},Jg=function(e,k){var K=e[0],z=e[1],U=e[2];return e[0]=k[0]*K+k[4]*z+k[8]*U+k[12],e[1]=k[1]*K+k[5]*z+k[9]*U+k[13],e[2]=k[2]*K+k[6]*z+k[10]*U+k[14],e},Kc=function(n,y){if(y){var h=l(y),W=G(y),N=n[0],E=n[1],X=n[2],I=n[3],U=n[8],g=n[9],k=n[10],v=n[11];n[0]=N*W-U*h,n[1]=E*W-g*h,n[2]=X*W-k*h,n[3]=I*W-v*h,n[8]=N*h+U*W,n[9]=E*h+g*W,n[10]=X*h+k*W,n[11]=I*h+v*W}},An=function(o,N){for(var D=o.s("grid.row.count"),u=o.s("grid.column.count"),Q=0;D>Q;Q++)for(var K=0;u>K;K++){var G=o.getCellRect(Q,K);if(M(G,N))return{rowIndex:Q,columnIndex:K,rect:G,grid:o}}return null},Gi=function(u,Y,q,H,N,O){var e={},v=q-u,z=H-Y,X=t.sqrt(v*v+z*z),C=v/X,D=z/X,Z=(-u+N)*C+(-Y+O)*D;return 0>=Z?(e.x=u,e.y=Y):Z>=X?(e.x=q,e.y=H):(e.x=u+Z*C,e.y=Y+Z*D),v=N-e.x,z=O-e.y,e.z=t.sqrt(v*v+z*z),e},xp=function(Q,w){var s,a,O,j,e,Y,Z,I,M=Q.getPoints(),c=Q.getSegments(),F=Q.p(),z=Q.getRotation();if(!c||!(c.indexOf(3)>0||c.indexOf(4)>0)){for(I=0;I<=M.size()-1;I++)if(I===M.size()-1?(e=M.get(0),j=M.get(I)):(j=M.get(I),e=M.get(I+1)),j=ns(F,j.x-F.x,j.y-F.y,z),e=ns(F,e.x-F.x,e.y-F.y,z),Y=Gi(j.x,j.y,e.x,e.y,w.x,w.y),Z=Y.z,Z<(Q.s("shape.border.width")||10)){a=j,O=e,s=I;break}if(s!=n){var i=Gi(a.x,a.y,O.x,O.y,w.x,w.y),J=b(a,i);return{attachIndex:s,attachOffset:J}}}},kg=function(z){for(var M=z._data,r=M.p(),I=M.getRotation(),U=M.getPoints(),O=n,G=[],L=0;L<U.size();L++)O=U.get(L),G.push(ns(r,O.x-r.x,O.y-r.y,I));z._55O.$15l=G};H.setImage("xeditinteractor_parentIcon",c),H.setImage("xeditinteractor_hostIcon",N),H.setImage("xeditinteractor_edgeIcon",_),H.setImage("xeditinteractor_removeIcon",zc),H.setImage("xeditinteractor_sourceIcon",Dg),H.setImage("xeditinteractor_targetIcon",ic),H.setImage("xeditinteractor_elevationIcon",Gh),H.setImage("xeditinteractor_tallIcon",pf),R._editPointSize=d?24:9,R._edgeHelpers=["parent","remove","source","target"],R._leftTopHelpers=["parent"],R._rightTopHelpers=["host"],R._leftBottomHelpers=["edge"],R._rightBottomHelpers=["remove"],Mf=Mf.concat(Mf).concat(Mf),L._79o=function(){var E=this,N=E.gv,A=N.getZoom(),T=N._editInteractor,C=fd.call(E);if(!C)return null;var s=rp(E,!0),Y=s[0],H=s[1],W={x:C.x,y:C.y,width:C.width,height:C.height},P=y(Y,H);if(T instanceof D.XEditInteractor){W=e(W,P);var Q=E._55O,g=N.getEditPointSize()/A+2,G=0;Q&&Q._43O&&(G+=g/2,$(W,G))}return W},L._47O=function(z){var F=this,R=F.gv,X=R._editInteractor;X instanceof D.XEditInteractor||Lj.call(F,z)},L.rectIntersects=function(i){var R=this,T=R._data,u=R.gv,h=u.getZoom(),Q=R._55O,g=u._editInteractor;if(g instanceof D.XEditInteractor&&u.isEditable(T)&&Q&&Q._43O&&"points"===T.s("edge.type")){var p=T.s("edge.points"),X=T.s("edge.segments");p=hn(R,p),X&&X.size()||(X=gm(p)),p=p._as;var O=!1,Y=d?5:1,$=i.x+Y,S=i.y+Y,v={x:$,y:S};if(g._edge===T&&g._hoverSegmentIndex>=0){var I=u._editInteractor._hoverSegmentIndex,f=X.get(I),K=se(T,R,I),a=n;if(K!=n&&K>=0){var C=p[K],V=u.getSegmentHoverWidth()/h;if(2===f||1===f){var Z=p[K+1];a=Eg(new _b(C.x,C.y),new _b(Z.x,Z.y),new _b(v.x-V,v.y-V),new _b(v.x+2*V,v.y+2*V)),a.$62l===m&&(O=!0)}else if(3===f){var F=p[K+1],Z=p[K+2];a=jc(new _b(C.x,C.y),new _b(F.x,F.y),new _b(Z.x,Z.y),new _b(v.x-V,v.y-V),new _b(v.x+2*V,v.y+2*V)),a.$62l===m&&(O=!0)}else if(4===f){var t=p[K+1],J=p[K+2];Z=p[K+3],a=Sk(new _b(C.x,C.y),new _b(t.x,t.y),new _b(J.x,J.y),new _b(Z.x,Z.y),new _b(v.x-V,v.y-V),new _b(v.x+2*V,v.y+2*V)),a.$62l===m&&(O=!0)}}}if(O)return!0}return n},h._47O=function(i){var B=this,N=B.gv,u=N._editInteractor;u instanceof D.XEditInteractor||nm.call(B,i)},h.rectIntersects=function($){var E=this,N=E._data,F=E.gv,u=F.getZoom(),T=E._55O,v=F._editInteractor;if(v instanceof D.XEditInteractor&&F.isEditable(N)&&T&&T._43O){var j=T.$15l,P=!1,L=d?5:1,r=$.x+L,x=$.y+L,z={x:r,y:x};if(j&&j.length===N.getPoints().size()||(kg(E),j=T.$15l),v._shape===N&&v._hoverSegmentIndex>=0){var f=N.getSegments();f&&f.size()||(f=gm(j));var t=F._editInteractor._hoverSegmentIndex,h=f.get(t),w=se(N,E,t),Q=n;if(w!=n&&w>=0){var O=j[w],i=F.getSegmentHoverWidth()/u;if(2===h||1===h){var H=j[w+1];Q=Eg(new _b(O.x,O.y),new _b(H.x,H.y),new _b(z.x-i,z.y-i),new _b(z.x+2*i,z.y+2*i)),Q.$62l===m&&(P=!0)}else if(3===h){var k=j[w+1],H=j[w+2];Q=jc(new _b(O.x,O.y),new _b(k.x,k.y),new _b(H.x,H.y),new _b(z.x-i,z.y-i),new _b(z.x+2*i,z.y+2*i)),Q.$62l===m&&(P=!0)}else if(4===h){var Y=j[w+1],e=j[w+2];H=j[w+3],Q=Sk(new _b(O.x,O.y),new _b(Y.x,Y.y),new _b(e.x,e.y),new _b(H.x,H.y),new _b(z.x-i,z.y-i),new _b(z.x+2*i,z.y+2*i)),Q.$62l===m&&(P=!0)}}}if(P)return!0}return n},h._48O=function(){var X=this,w=X.gv,g=w._editInteractor;g instanceof D.XEditInteractor?(F._48O.call(X),X._55O._43O&&kg(X)):rl.call(X)},h._79o=function(){var r=this,i=r.gv,F=i.getZoom(),J=i._editInteractor,E=nk.call(r);if(E){var m={x:E.x,y:E.y,width:E.width,height:E.height};if(J instanceof D.XEditInteractor){var k=r._55O,x=i.getEditPointSize()/F+2,R=0;k&&k._43O&&(R+=x/2,$(m,R))}return m}},F._47O=function(C){var x=this,z=x.gv,Z=z._editInteractor;if(Z instanceof D.XEditInteractor);else{var s=x._55O;s&&s._98o&&Fh.call(x,C)}},F.getSelectWidth=function(){var c=this,s=c.gv,V=s._editInteractor,H=c._data;return s.isEditable(H)&&V instanceof D.XEditInteractor?0:$f.call(c)},F._80o=function(C){var P=this,m=P.gv._editInteractor;if(go.call(P,C),m&&m._debug){C.save(),C.beginPath(),C.lineWidth=1,C.strokeStyle="green";var Y=P._79o();Y&&(C.rect(Y.x,Y.y,Y.width,Y.height),C.stroke()),C.restore()}},h._80o=function(B){var u=this,N=u.gv._editInteractor;if(xb.call(u,B),N&&N._debug){B.save(),B.beginPath(),B.lineWidth=1,B.strokeStyle="green";var J=u._79o();B.rect(J.x,J.y,J.width,J.height),B.stroke(),B.restore()}},F._48O=function(){var v=this,h=v.gv,U=v._data,z=h._editInteractor,d=v._55O,K=U.p(),m=U.getRotation();if(z instanceof D.XEditInteractor){if(d._42O){var e=Ir(K,U.getWidth(),U.getHeight(),m),S=e[0],x=e[1],L=e[2],n=e[3],G=e[4],s=e[5],A=e[6],N=e[7];d.$45l=[S,G,x,s,n,A,L,N]}}else bd.call(v)},R.getResizeMode=function(){return this.$25l||"normal"},R.setResizeMode=function(x){var B=this.$25l;this.$25l=x,this.fp("resizeMode",B,x)},R.getSnapAngle=function(){return this.$26l||Math.PI/36},R.setSnapAngle=function(V){var h=this.$26l;this.$26l=V,this.fp("snapAngle",h,V)},R.getSnapSpacing=function(){return this.$27l},R.setSnapSpacing=function(d){var e=this.$27l;this.$27l=d,this.fp("snapSpacing",e,d)},R.getPointSnapSpacing=function(){return this._pointSnapSpacing},R.setPointSnapSpacing=function(Y){var N=this._pointSnapSpacing;this._pointSnapSpacing=Y,this.fp("pointSnapSpacing",N,Y)},R.setHelperEditableFunc=function(n){var R=this._helperEditableFunc;this._helperEditableFunc=n,this.fp("helperEditableFunc",R,n)},R.getHelperEditableFunc=function(){return this._helperEditableFunc},R.setLeftTopHelpers=function(M){var f=this._leftTopHelpers;this._leftTopHelpers=M,this.fp("leftTopHelpers",f,M)},R.getLeftTopHelpers=function(){return this._leftTopHelpers},R.setLeftTopHelpersAlign=function(X){var R=this._leftTopHelpersAlign;this._leftTopHelpersAlign=X,this.fp("leftTopHelpersAlign",R,X)},R.getLeftTopHelpersAlign=function(){return this._leftTopHelpersAlign},R.setRightTopHelpers=function(V){var w=this._rightTopHelpers;this._rightTopHelpers=V,this.fp("rightTopHelpers",w,V)},R.getRightTopHelpers=function(){return this._rightTopHelpers},R.setRightTopHelpersAlign=function(P){var n=this._rightTopHelpersAlign;this._rightTopHelpersAlign=P,this.fp("rightTopHelpersAlign",n,P)},R.getRightTopHelpersAlign=function(){return this._rightTopHelpersAlign},R.setLeftBottomHelpers=function(l){var D=this._leftBottomHelpers;this._leftBottomHelpers=l,this.fp("leftBottomHelpers",D,l)},R.getLeftBottomHelpers=function(){return this._leftBottomHelpers},R.setLeftBottomHelpersAlign=function(X){var e=this._leftBottomHelpersAlign;this._leftBottomHelpersAlign=X,this.fp("leftBottomHelpersAlign",e,X)},R.getLeftBottomHelpersAlign=function(){return this._leftBottomHelpersAlign},R.setRightBottomHelpers=function($){var h=this._rightBottomHelpers;this._rightBottomHelpers=$,this.fp("rightBottomHelpers",h,$)},R.getRightBottomHelpers=function(){return this._rightBottomHelpers},R.setRightBottomHelpersAlign=function(x){var g=this._rightBottomHelpersAlign;this._rightBottomHelpersAlign=x,this.fp("rightBottomHelpersAlign",g,x)},R.getRightBottomHelpersAlign=function(){return this._rightBottomHelpersAlign},R.setEdgeHelpers=function(g){var d=this._edgeHelpers;this._edgeHelpers=g,this.fp("edgeHelpers",d,g)},R.getEdgeHelpers=function(){return this._edgeHelpers},R.isHelperEditable=function(g,X){return g instanceof T&&("host"===X||"edge"===X||"elevation"===X||"tall"===X)?!1:g instanceof k&&("source"===X||"target"===X)?!1:"pointElevation"===X?this._helperEditableFunc?this._helperEditableFunc(g,X):!1:this._helperEditableFunc?this._helperEditableFunc(g,X):!0},R.getEditHelperSize=function(){return this._editHelperSize||(d?28:16)},R.setEditHelperSize=function(L){var l=this._editHelperSize;this._editHelperSize=L,this.fp("editHelperSize",l,L)},R.getEditRectBorderColor=function(){return this.$28l||"rgb(0, 168, 255)"},R.setEditRectBorderColor=function(i){var A=this.$28l;this.$28l=i,this.fp("editRectBorderColor",A,i)},R.getNodeBorderColor=function(){return this.$29l||"#1ABC9C"},R.setNodeBorderColor=function(H){var $=this.$29l;this.$29l=H,this.fp("nodeBorderColor",$,H)},R.getEditRectBorderStyle=function(){return this.$30l||"dashed"},R.setEditRectBorderStyle=function(S){var i=this.$30l;this.$30l=S,this.fp("editRectBorderStyle",i,S)},R.getControlPointBackground=function(){return this.$31l||"#ff0"},R.setControlPointBackground=function(x){var k=this.$31l;this.$31l=x,this.fp("controlPointBackground",k,x)},R.getControlPointBorderColor=function(){return this.$32l||this._editPointBorderColor},R.setControlPointBorderColor=function(w){var t=this.$32l;this.$32l=w,this.fp("controlPointBorderColor",t,w)},R.getJoinPointBackground=function(){return this.$33l||this._editPointBackground},R.setJoinPointBackground=function(o){var S=this.$33l;this.$33l=o,this.fp("joinPointBackground",S,o)},R.getJoinPointBorderColor=function(){return this.$34l||this._editPointBorderColor},R.setJoinPointBorderColor=function(N){var m=this.$34l;this.$34l=N,this.fp("joinPointBorderColor",m,N)},R.getDirectionLineColor=function(){return this.$35l||"#888"},R.setDirectionLineColor=function(g){var H=this.$35l;this.$35l=g,this.fp("directionLineColor",H,g)},R.getSegmentHoverColor=function(){return this.$36l||"rgba(255, 0, 0, 0.3)"},R.setSegmentHoverColor=function(r){var k=this.$36l;this.$36l=r,this.fp("segmentHoverColor",k,r)},R.getSegmentHoverWidth=function(){return this.$22l||(d?16:8)},R.setSegmentHoverWidth=function(w){var $=this.$22l;this.$22l=w,this.fp("segmentHoverWidth",$,w)},R.getSnapPointBorderColor=function(){return this.$38l||"#f00"},R.setSnapPointBorderColor=function(O){var T=this.$38l;this.$38l=O,this.fp("snapPointBorderColor",T,O)},R.getEditRectPadding=function(){return this.$39l!=n?this.$39l:6},R.setEditRectPadding=function(t){var l=this.$39l;this.$39l=t,this.fp("editRectPading",l,t)},R.isRectEditable=function(Q){var S=this,b=S._editInteractor;return b instanceof D.XEditInteractor?S._rectEditableFunc?S._rectEditableFunc(Q):!0:bh.call(S,Q)},R.isPointEditable=function(u){var E=this,g=E._editInteractor;return g instanceof D.XEditInteractor?E._pointEditableFunc?E._pointEditableFunc(u):!0:cq.call(E,u)},R.validateImpl=function(){var g=this,q=g.$14l,B=g._editInteractor;if(q){var R=g.getWidth(),E=g.getHeight();(R!==q.clientWidth||E!==q.clientHeight)&&(B&&(B._68I=1),o.setCanvas(q,R,E),g._32I=1)}il.call(this)},R.isEditable=function(s){var O=kc.call(this,s),o=this._editInteractor;if(o instanceof D.XEditInteractor&&s instanceof T){if(!s.s("2d.editable"))return!1;var W=this.getEditableFunc();O=W?W(s):!0}return O},R._42=function(e,F){var i=this,W=i._editInteractor;jf.call(i,e,F),W instanceof D.XEditInteractor&&W._68I&&W._42()},R.isSnapPoint=function(){return!0};var Rh=function(N){arguments.length>0&&this.$58l(N)},zf=Rh.prototype;zf.$58l=function(q){this.$62l=q,this.points=new Array},zf.$56l=function(I){this.points.push(I)},zf.$57l=function(i){this.points=this.points.concat(i)};var _b=function(n,Z){arguments.length>0&&this.$58l(n,Z)},Gq=_b.prototype;Gq.$58l=function(h,O){this.x=h,this.y=O},Gq.add=function(Y){return new _b(this.x+Y.x,this.y+Y.y)},Gq.addEquals=function(C){return this.x+=C.x,this.y+=C.y,this},Gq.$55l=function(G){return new _b(this.x*G,this.y*G)},Gq.eq=function(Z){return this.x==Z.x&&this.y==Z.y},Gq.lt=function(F){return this.x<F.x&&this.y<F.y},Gq.lte=function(f){return this.x<=f.x&&this.y<=f.y},Gq.gt=function(l){return this.x>l.x&&this.y>l.y},Gq.gte=function(H){return this.x>=H.x&&this.y>=H.y},Gq.lerp=function(c,j){return new _b(this.x+(c.x-this.x)*j,this.y+(c.y-this.y)*j)},Gq.distanceFrom=function(S){var _=this.x-S.x,c=this.y-S.y;return P(_*_+c*c)},Gq.min=function(D){return new _b(Z(this.x,D.x),Z(this.y,D.y))},Gq.max=function(j){return new _b(Q(this.x,j.x),Q(this.y,j.y))},Gq.toString=function(){return this.x+","+this.y};var yc=function(){this.$58l(arguments)},Oq=yc.prototype;yc.TO=1e-6,yc.AC=6,Oq.$58l=function(Q){this.co=new Array;for(var A=Q.length-1;A>=0;A--)this.co.push(Q[A])},Oq.$55l=function(T){for(var I=new yc,z=0;z<=this.$50l()+T.$50l();z++)I.co.push(0);for(var z=0;z<=this.$50l();z++)for(var t=0;t<=T.$50l();t++)I.co[z+t]+=this.co[z]*T.co[t];return I},Oq.$59l=function(){for(var I=this.$50l();I>=0&&J(this.co[I])<=yc.TO;I--)this.co.pop()},Oq.$50l=function(){return this.co.length-1},Oq.$51l=function(){var u;switch(this.$59l(),this.$50l()){case 0:u=new Array;break;case 1:u=this.$52l();break;case 2:u=this.$53l();break;case 3:u=this.$54l();break;case 4:u=this.$63l();break;default:u=new Array}return u},Oq.$52l=function(){var t=new Array,Q=this.co[1];return 0!=Q&&t.push(-this.co[0]/Q),t},Oq.$53l=function(){var f=new Array;if(2==this.$50l()){var K=this.co[2],e=this.co[1]/K,t=this.co[0]/K,d=e*e-4*t;if(d>0){var r=P(d);f.push(.5*(-e+r)),f.push(.5*(-e-r))}else 0==d&&f.push(.5*-e)}return f},Oq.$63l=function(){var M=new Array;if(4==this.$50l()){var h=this.co[4],L=this.co[3]/h,r=this.co[2]/h,i=this.co[1]/h,c=this.co[0]/h,z=new yc(1,-r,L*i-4*c,-L*L*c+4*r*c-i*i).$54l(),S=z[0],W=L*L/4-r+S;if(J(W)<=yc.TO&&(W=0),W>0){var v=P(W),U=3*L*L/4-v*v-2*r,p=(4*L*r-8*i-L*L*L)/(4*v),$=U+p,e=U-p;if(J($)<=yc.TO&&($=0),J(e)<=yc.TO&&(e=0),$>=0){var B=P($);M.push(-L/4+(v+B)/2),M.push(-L/4+(v-B)/2)}if(e>=0){var B=P(e);M.push(-L/4+(B-v)/2),M.push(-L/4-(B+v)/2)}}else if(0>W);else{var p=S*S-4*c;if(p>=-yc.TO){if(0>p&&(p=0),p=2*P(p),U=3*L*L/4-2*r,U+p>=yc.TO){var l=P(U+p);M.push(-L/4+l/2),M.push(-L/4-l/2)}if(U-p>=yc.TO){var l=P(U-p);M.push(-L/4+l/2),M.push(-L/4-l/2)}}}}return M},Oq.$54l=function(){var A=new Array;if(3==this.$50l()){var c=this.co[3],p=this.co[2]/c,I=this.co[1]/c,D=this.co[0]/c,Z=(3*I-p*p)/3,Q=(2*p*p*p-9*I*p+27*D)/27,i=p/3,F=Q*Q/4+Z*Z*Z/27,U=Q/2;if(J(F)<=yc.TO&&(F=0),F>0){var e,Y,W=P(F);e=-U+W,Y=e>=0?z(e,1/3):-z(-e,1/3),e=-U-W,e>=0?Y+=z(e,1/3):Y-=z(-e,1/3),A.push(Y-i)}else if(0>F){var $=P(-Z/3),h=X(P(-F),-U)/3,n=G(h),d=l(h),C=P(3);A.push(2*$*n-i),A.push(-$*(n+C*d)-i),A.push(-$*(n-C*d)-i)}else{var e;e=U>=0?-z(U,1/3):z(-U,1/3),A.push(2*e-i),A.push(-e-i)}}return A};var Nb=function(f,I){arguments.length>0&&this.$58l(f,I)},po=Nb.prototype;po.$58l=function(r,X){this.x=r,this.y=X},po.length=function(){return P(this.x*this.x+this.y*this.y)},po.$60l=function(b){return this.x*b.x+this.y*b.y};var Lc=function(G,N,W,M){var d,c=(M.x-W.x)*(G.y-W.y)-(M.y-W.y)*(G.x-W.x),o=(N.x-G.x)*(G.y-W.y)-(N.y-G.y)*(G.x-W.x),Z=(M.y-W.y)*(N.x-G.x)-(M.x-W.x)*(N.y-G.y);if(0!=Z){var F=c/Z,H=o/Z;F>=0&&1>=F&&H>=0&&1>=H?(d=new Rh(m),d.points.push(new _b(G.x+F*(N.x-G.x),G.y+F*(N.y-G.y)))):d=new Rh(U)}else d=0==c||0==o?new Rh("C"):new Rh("P");return d},op=function(x,H,S,i,M){var s,y,T,X,Z,V,K,E=i.min(M),v=i.max(M),p=new Rh(U);s=H.$55l(-2),T=x.add(s.add(S)),s=x.$55l(-2),y=H.$55l(2),X=s.add(y),Z=new _b(x.x,x.y),K=new Nb(i.y-M.y,M.x-i.x),V=i.x*M.y-M.x*i.y;for(var r=new yc(K.$60l(T),K.$60l(X),K.$60l(Z)+V).$51l(),P=0;P<r.length;P++){var L=r[P];if(L>=0&&1>=L){var u=x.lerp(H,L),b=H.lerp(S,L),R=u.lerp(b,L);i.x==M.x?E.y<=R.y&&R.y<=v.y&&(p.$62l=m,p.$56l(R)):i.y==M.y?E.x<=R.x&&R.x<=v.x&&(p.$62l=m,p.$56l(R)):R.gte(E)&&R.lte(v)&&(p.$62l=m,p.$56l(R))}}return p},jc=function(O,K,Z,d,G){var R=d.min(G),e=d.max(G),C=new _b(e.x,R.y),i=new _b(R.x,e.y),$=op(O,K,Z,R,C),S=op(O,K,Z,C,e),r=op(O,K,Z,e,i),F=op(O,K,Z,i,R),W=new Rh(U);return W.$57l($.points),W.$57l(S.points),W.$57l(r.points),W.$57l(F.points),W.points.length>0&&(W.$62l=m),W},Wr=function(j,Y,Z,P,g,J){var $,u,e,d,M,c,L,T,V,W,n=g.min(J),F=g.max(J),x=new Rh(U);$=j.$55l(-1),u=Y.$55l(3),e=Z.$55l(-3),d=$.add(u.add(e.add(P))),M=new Nb(d.x,d.y),$=j.$55l(3),u=Y.$55l(-6),e=Z.$55l(3),d=$.add(u.add(e)),c=new Nb(d.x,d.y),$=j.$55l(-3),u=Y.$55l(3),e=$.add(u),L=new Nb(e.x,e.y),T=new Nb(j.x,j.y),W=new Nb(g.y-J.y,J.x-g.x),V=g.x*J.y-J.x*g.y;for(var A=new yc(W.$60l(M),W.$60l(c),W.$60l(L),W.$60l(T)+V).$51l(),v=0;v<A.length;v++){var i=A[v];if(i>=0&&1>=i){var w=j.lerp(Y,i),R=Y.lerp(Z,i),K=Z.lerp(P,i),o=w.lerp(R,i),E=R.lerp(K,i),r=o.lerp(E,i);g.x==J.x?n.y<=r.y&&r.y<=F.y&&(x.$62l=m,x.$56l(r)):g.y==J.y?n.x<=r.x&&r.x<=F.x&&(x.$62l=m,x.$56l(r)):r.gte(n)&&r.lte(F)&&(x.$62l=m,x.$56l(r))}}return x},Sk=function(d,v,S,h,W,n){var P=W.min(n),B=W.max(n),z=new _b(B.x,P.y),j=new _b(P.x,B.y),D=Wr(d,v,S,h,P,z),F=Wr(d,v,S,h,z,B),X=Wr(d,v,S,h,B,j),r=Wr(d,v,S,h,j,P),L=new Rh(U);return L.$57l(D.points),L.$57l(F.points),L.$57l(X.points),L.$57l(r.points),L.points.length>0&&(L.$62l=m),L},Eg=function(C,Z,H,n){var $=H.min(n),J=H.max(n),y=new _b(J.x,$.y),S=new _b($.x,J.y),x=Lc($,y,C,Z),Q=Lc(y,J,C,Z),F=Lc(J,S,C,Z),f=Lc(S,$,C,Z),e=new Rh(U);return e.$57l(x.points),e.$57l(Q.points),e.$57l(F.points),e.$57l(f.points),e.points.length>0&&(e.$62l=m),e},Kh=D.XEditInteractor=function(U){var p=this,N=p._view=document.createElement("canvas");N.className="editCanvas",N.style.position="absolute",Kh.superClass.constructor.call(p,U)};H.def(Kh,D.Interactor,{ms_edit:1,setUp:function(){var S=this,O=S.gv,V=O.getView(),$=S._view;Kh.superClass.setUp.call(S),O.setEditInteractor(S),O.$14l=$,O._79O?V.insertBefore($,O._79O):V.appendChild($);var j=S.$49l=S.$11l.bind(S);O.dm().md(j),O.sm().ms(j),O.mp(j)},tearDown:function(){var E=this,T=E.gv,l=T.getView(),Z=E.$49l;Kh.superClass.tearDown.call(E),T.setEditInteractor(n),T.$14l=n,l.removeChild(E._view),T.dm().umd(Z),T.sm().ums(Z),T.ump(Z)},clear:function(){var b=this,_=b.gv;delete b._hoverSegmentIndex,delete b._edge,delete b._shape,delete _._editing,delete b.$10l,delete b.$13l,delete b.$9l,delete b._removePointIndex,delete b._lp,b.$12l="",delete b.$40l,delete b.$67l,delete b.$72l,delete b.$73l,delete b.$75l,delete b.$1l,delete b.$3l,delete b.$2l,delete b.$92l,delete b.$93l,delete b.$94l,b.clearDragging()},handle_keydown:function(v){this.$48l!==v.shiftKey&&(this.$48l=v.shiftKey,this.handle_mousemove(v,K,!0))},handle_keyup:function(O){this.$48l!==O.shiftKey&&(this.$48l=O.shiftKey,this.handle_mousemove(O,K,!0))},handle_touchstart:function(j){this.handle_mousemove(j),this.handle_mousedown(j)},handle_mousedown:function(G){W(G);var i=this,q=i.$13l,D=i.gv,S=D.dm(),t=D.sm(),s=D.getZoom(),b=D.lp(G),X=H.isDoubleClick(G),d=H.isLeftButton(G),p=i.$7l,l=i._shape,N=i._hoverSegmentIndex,y=i._edge,v=i.$87l,x=i.$88l,E=function(){i._68I||v===i.$87l&&x===i.$88l||i.$43l()};if(7!==i.$67l&&(delete i.$87l,delete i.$88l),d&&(l||y)&&N>=0&&X&&(l&&t.contains(l)||y&&t.contains(y))){var L=Qq.call(i,l||y,N,b);return i.addShapePoint(l||y,N,L),O(function(){i.handle_mousemove(G)},40),void 0}if(d&&(l||y)&&i._removePointIndex>=0&&X)return i.removeShapePoint(),i.$5l=1,O(function(){i.handle_mousemove(G)},40),void 0;if(!d||!D._editing)return E(),void 0;if(l&&q>=0){var M=l.getPoints().get(q),Y=l.p(),R=ns(Y,M.x-Y.x,M.y-Y.y,-p+l.getRotation());F=ns(Y,b.x-Y.x,b.y-Y.y,-p),i.$24l={x:F.x-R.x,y:F.y-R.y},i.startDragging(G),S.beginTransaction(),i.fi({kind:"beginEditPoint",event:G,data:l,index:q}),i.$88l=q,i.$87l=l}else if(i.$10l){var c=D.sm().getSelection(),f=i.$6l,K=i.$1l={},r=i.$3l={},u=i.$16l[V[i.$10l]],j={x:f.x,y:f.y},J={x:f.x+f.width/2,y:f.y+f.height/2};i.$24l={x:b.x-u.x/s,y:b.y-u.y/s},i.$2l=a(i.$8l),i.$4l=a(f),c.each(function(y){if(y instanceof k){var H=y.p(),Y=y.getWidth(),U=y.getHeight(),w=ns(J,H.x-J.x,H.y-J.y,-p);K[y.getId()]={x:H.x-Y/2,y:H.y-U/2,width:Y,height:U},r[y.getId()]={x:(w.x-j.x)/f.width,y:(w.y-j.y)/f.height}}}),i.startDragging(G),S.beginTransaction(),i.fi({kind:"beginEditRect",event:G,direction:i.$10l})}else if(y&&q>=0){var w=hn(D.getDataUI(y),y.s("edge.points")),M=w.get(q);i.$24l={x:b.x-M.x,y:b.y-M.y},i.startDragging(G),S.beginTransaction(),i.fi({kind:"beginEditPoint",event:G,data:y,index:q}),i.$88l=q,i.$87l=y}else if(i.$40l){var f=i.$6l,J={x:f.x+f.width/2,y:f.y+f.height/2},I=a(i.$23l);I.x/=s,I.y/=s;var C=ns(J,I.x-J.x,I.y-J.y,-p),F=ns(J,b.x-J.x,b.y-J.y,-p);i.$24l={x:F.x-C.x,y:F.y-C.y},i.startDragging(G),S.beginTransaction(),i.fi({kind:"beginEditRotation",event:G,data:i._rotationNode})}else if([1,2,3,5,6,7,8,9].indexOf(i.$67l)>=0){var e=i.$67l;(7===e||8===e||9===e)&&S.beginTransaction(),i.startDragging(G)}else if(i.$71l&&X&&i.$79l(i.$71l,b)){var g=t.toSelection();S.beginTransaction(),g.each(function(H){S.remove(H)}),S.endTransaction()}E()},$11l:function(){var J=this,D=J.gv;D._editing&&(J.$13l==n||J._shape==n&&J._edge==n)&&(J.$73l==n||1!==J.$67l&&5!==J.$67l&&6!==J.$67l)||(J.$5l=1),J._68I=1},$46l:function(A){var O=this,e=O.gv,L=e.lp(A),o=[];return sn(e,function(H){var f=e.getDataUI(H);if(f){var P=f._79o();M(P,L)&&o.push(H)}}),o},$47l:function(v){var X=this,x=X.$13l,D=X.gv.dm();X.$10l?(X.fi({kind:"endEditRect",event:v,direction:X.$10l}),D.endTransaction()):X._shape&&x>=0?(X.fi({kind:"endEditPoint",event:v,data:X._shape,index:x}),D.endTransaction()):X._edge&&x>=0?(X.fi({kind:"endEditPoint",event:v,data:X._edge,index:x}),D.endTransaction()):X.$23l&&X.$40l&&(X.fi({kind:"endEditRotation",event:v}),D.endTransaction())},handleWindowTouchEnd:function(G){this.handleWindowMouseUp(G)},handleWindowMouseUp:function(Y){var F=this,A=F.gv,x=A.dm(),W=F._shape,v=F._edge,e=F.$13l,V=F.$40l,J=F.$9l,C=F.$10l,D=F.$67l;if((W||v)&&e>=0&&J>=0){var f,q;if(W){var b=W.p(),M=W.getRotation();f=W.getPoints(),q=f.get(J),ug(W,b,M,e,q,!1)}else if(f=hn(A.getDataUI(v),v.s("edge.points"),!0),q=f.get(J),0===e){var B=f.get(0);v.s("edge.source.offset.x",q.x-B.x),v.s("edge.source.offset.y",q.y-B.y)}else if(e===f.size()-1){var j=f.get(f.size()-1);v.s("edge.target.offset.x",q.x-j.x),v.s("edge.target.offset.y",q.y-j.y)}else"points"===v.s("edge.type")&&(f.set(e,q),v.s("edge.points",ds(f)))}F.$47l(Y);var $=F.$73l;1===D?(x.beginTransaction(),$?A.sm().each(function(Z){if(Z.setHost&&A.isHelperEditable(Z,"host")){Z.setHost($);
var w=F.$75l,c=F.$74l;w&&(Z.s("attach.row.index",w.rowIndex),Z.s("attach.column.index",w.columnIndex)),c&&(Z.s("attach.index",c.attachIndex),Z.s("attach.offset",c.attachOffset),Z.s("attach.offset.relative",!1),Z.s("attach.offset.opposite",!1))}}):A.sm().each(function(z){z.setHost&&A.isHelperEditable(z,"host")&&(z.setHost(n),z.s("attach.row.index",K),z.s("attach.column.index",K),z.s("attach.index",K),z.s("attach.offset",K),z.s("attach.offset.relative",!1),z.s("attach.offset.opposite",!1))}),x.endTransaction()):2===D?(x.beginTransaction(),$?A.sm().each(function(u){u.setParent&&A.isHelperEditable(u,"parent")&&u.setParent($)}):A.sm().each(function(b){b.setParent&&A.isHelperEditable(b,"parent")&&b.setParent(n)}),x.endTransaction()):3===D?$&&(x.beginTransaction(),A.sm().each(function(j){if(A.isHelperEditable(j,"edge")&&j instanceof k&&$ instanceof k){var L=new S.Edge;x.add(L),L.setSource(j),L.setTarget($),F.onEdgeCreated&&F.onEdgeCreated(Y,L)}}),x.endTransaction()):5===D||6===D?$&&(x.beginTransaction(),A.sm().each(function(s){s instanceof T&&$ instanceof k&&(5===D&&A.isHelperEditable(s,"source")?s.setSource($):6===D&&A.isHelperEditable(s,"source")&&s.setTarget($))}),x.endTransaction()):(7===D||8===D||9===D)&&x.endTransaction(),(C||V)&&F.$43l(!0),d?(F.clear(),delete F.$64l,F._68I||F.$43l()):(F.handle_mousemove(Y,!0),D&&!F._68I&&F.$43l())},handleWindowTouchMove:function(I){this.handleWindowMouseMove(I)},handleWindowMouseMove:function(i){this._78I(i)},handle_mousemove:function(s,X,A){if(!this._pause){if(!A){var h=d?Bj(s):s;this.$61l={clientX:h.clientX,clientY:h.clientY}}if(X===!0||!B()){var W=this,x=W.gv,y=!1,g=n;W.clear(),x.sm().size()>0&&(g=x.lp(A?W.$61l:s),y=W._79I(s,g)),y&&(x._editing=1),W.$12l!==W.$65l&&(W.$65l=W.$12l,W.setCursor(W.$12l)),W.$40l!==W.$64l&&(W.$64l=W.$40l,W._68I||W.$43l()),W._hoverSegmentIndex!==W.$66l&&(W.$66l=W._hoverSegmentIndex,W._68I||W.$43l())}}},_78I:function(e){this.autoScroll(e);var z=this,c=z.gv,F=c.lp(e),u=c.getZoom(),I=z.$13l;if((z._shape||z._edge)&&I>=0){var N,g,d,S=z._shape,$=z._edge,G=z.$24l,E=c.getPointSnapSpacing(),L=function(I,b){return E==n||isNaN(E)?{x:I,y:b}:{x:r(I/E)*E,y:r(b/E)*E}};if(S){N=S.getPoints();var p=S.p(),h=S.getRotation(),q=0;g=ns(p,F.x-p.x,F.y-p.y,-h),ug(S,p,h,I,F,!0,G,L),z.fi({kind:"betweenEditPoint",event:e,data:S,index:I})}else if($){N=hn(c.getDataUI($),$.s("edge.points"),!0),F.x-=G.x,F.y-=G.y,g=F;var Y,v,t=$.s("edge.offset"),x=N.size(),B=x>2;if(0===I){var y=N.get(0);t&&(y=tf(y,N.get(1),-t,B),F=tf(F,N.get(1),-t,B)),Y=F.x-y.x,v=F.y-y.y,d=L(Y,v),$.s("edge.source.offset.x",d.x),$.s("edge.source.offset.y",d.y)}else if(I===x-1){var V=N.get(x-1);t&&(V=tf(V,N.get(x-2),-t,B),F=tf(F,N.get(x-2),-t,B)),Y=F.x-V.x,v=F.y-V.y,d=L(Y,v),$.s("edge.target.offset.x",d.x),$.s("edge.target.offset.y",d.y)}else"points"===$.s("edge.type")&&(d=L(F.x,F.y),d.e=N.get(I).e,N.set(I,d),$.s("edge.points",ds(N)));z.fi({kind:"betweenEditPoint",event:e,data:$,index:I})}if(delete z.$9l,c.isSnapPoint(S)||c.isSnapPoint($))for(q=0;q<N.size();q++)if(q!==I){var U=N.get(q);if(b(U,g)<c.getEditPointSize()/u){z.$9l=q;break}}}else if(z.$10l){var G=z.$24l;F.x-=G.x,F.y-=G.y;var a=c.sm().getSelection(),Z=z.$1l,o=z.$7l,l=z.$10l,D=z.$4l,Q=z.$2l,W=c.getEditRectPadding()/u,m=2*W,M=c.getSnapSpacing(),A=M!=n&&!isNaN(M),K=Tq(Q,F,l,o,2*W,c.getResizeMode(),A,!0),_=z.$6l;if(A){var i=K.width-m,R=K.height-m,f=r(i/M)*M,hk=r(R/M)*M,Wg=f-i,_j=hk-R;("west"===l||"northwest"===l||"southwest"===l)&&(Wg=-Wg),("north"===l||"northwest"===l||"northeast"===l)&&(_j=-_j),K=Tq(Q,F,l,o,2*W,c.getResizeMode(),A,!1,Wg,_j)}z.$8l=K,_.x=K.x+W,_.y=K.y+W,_.width=K.width-m,_.height=K.height-m;var _d=K.x+K.width/2,uj=K.y+K.height/2,Tf=_.x,um=_.y,nd=_.width/D.width,Ri=_.height/D.height;a.each(function(b){if(b instanceof k&&c.isEditable(b)&&c.isRectEditable(b)){var u=Z[b.getId()],$=z.$3l[b.getId()],B={x:u.x+u.width/2,y:u.y+u.height/2},n=0,p=0,M=l,f=180*J(o-b.getRotation())/C;"northeast"===l?f>=315||45>f?(n=u.width*nd+u.x,p=u.height*(1-Ri)+u.y,M="northeast"):f>=45&&135>f?(n=u.width*(1-Ri)+u.x,p=u.height*(1-nd)+u.y,M="northwest"):f>=135&&225>f?(n=u.width*(1-nd)+u.x,p=u.height*Ri+u.y,M="southwest"):(n=u.width*Ri+u.x,p=u.height*nd+u.y,M="southeast"):"north"===l?f>=315||45>f?(p=u.height*(1-Ri)+u.y,M="north"):f>=45&&135>f?(n=u.width*(1-Ri)+u.x,M="west"):f>=135&&225>f?(p=u.height*Ri+u.y,M="south"):(n=u.width*Ri+u.x,M="east"):"northwest"===l?f>=315||45>f?(n=u.width*(1-nd)+u.x,p=u.height*(1-Ri)+u.y,M="northwest"):f>=45&&135>f?(n=u.width*(1-Ri)+u.x,p=u.height*nd+u.y,M="southwest"):f>=135&&225>f?(n=u.width*nd+u.x,p=u.height*Ri+u.y,M="southeast"):(n=u.width*Ri+u.x,p=u.height*(1-nd)+u.y,M="northeast"):"west"===l?f>=315||45>f?(n=u.width*(1-nd)+u.x,M="west"):f>=45&&135>f?(p=u.height*nd+u.y,M="south"):f>=135&&225>f?(n=u.width*nd+u.x,M="east"):(p=u.height*(1-nd)+u.y,M="north"):"southwest"===l?f>=315||45>f?(n=u.width*(1-nd)+u.x,p=u.height*Ri+u.y,M="southwest"):f>=45&&135>f?(n=u.width*Ri+u.x,p=u.height*nd+u.y,M="southeast"):f>=135&&225>f?(n=u.width*nd+u.x,p=u.height*(1-Ri)+u.y,M="northeast"):(n=u.width*(1-Ri)+u.x,p=u.height*(1-nd)+u.y,M="northwest"):"east"===l?f>=315||45>f?(n=u.width*nd+u.x,M="east"):f>=45&&135>f?(p=u.height*(1-nd)+u.y,M="north"):f>=135&&225>f?(n=u.width*(1-nd)+u.x,M="west"):(p=u.height*nd+u.y,M="south"):"south"===l?f>=315||45>f?(p=u.height*Ri+u.y,M="south"):f>=45&&135>f?(n=u.width*Ri+u.x,M="east"):f>=135&&225>f?(p=u.height*(1-Ri)+u.y,M="north"):(n=u.width*(1-Ri)+u.x,M="west"):"southeast"===l&&(f>=315||45>f?(n=u.width*nd+u.x,p=u.height*Ri+u.y,M="southeast"):f>=45&&135>f?(n=u.width*Ri+u.x,p=u.height*(1-nd)+u.y,M="northeast"):f>=135&&225>f?(n=u.width*(1-nd)+u.x,p=u.height*(1-Ri)+u.y,M="northwest"):(n=u.width*(1-Ri)+u.x,p=u.height*nd+u.y,M="southwest"));var F=ns(B,n-B.x,p-B.y,b.getRotation());iq(b,u,M,{x:F.x,y:F.y});var v=Tf+_.width*$.x,Y=um+_.height*$.y,K={x:v,y:Y};K=ns({x:_d,y:uj},K.x-_d,K.y-uj,o),b.p(K.x,K.y)}}),z.fi({kind:"betweenEditRect",event:e,direction:l})}else if(z.$23l&&z.$40l){var Fp=z.$8l,Oo=Fp.width,Ze=Fp.height,p={x:Fp.x+Oo/2,y:Fp.y+Ze/2},G=z.$24l,kc=z.$23l,jc=kc.x/u-p.x,Wk=kc.y/u-p.y,gl=P(jc*jc+Wk*Wk),Bq=Math.asin(G.x/gl),hp=c.sm().getSelection(),Or=j+X(F.y-p.y,F.x-p.x)-Bq,to=c.getSnapAngle(),Or=r(Or/to)*to;0>Or&&(Or+=w);var on=Or-z.$7l,mc=[p.x,0,p.y];hp.each(function(A){if(c.isEditable(A)&&c.isRotationEditable(A)&&c.isVisible(A)){var N=dk(A.p3(),mc),S=Qb();Kc(S,-on),A.setRotation(A.getRotation()+on),Jg(N,S),A.p3(mc[0]+N[0],mc[1]+N[1],mc[2]+N[2])}}),z.$7l=Or,z.fi({kind:"betweenEditRotation",event:e})}else if([1,2,3,5,6].indexOf(z.$67l)>=0)z.$72l=e,z.$78l||(z.$78l=1,O(function(){H.isDragging()&&z.$43l(),delete z.$78l},12));else if(7===z.$67l){if(z.$87l instanceof s){var S=z.$87l,jo=z.$88l,xb=H.clone(S.getPoints().get(jo)),ue=F.y-xb.y;xb.e||(xb.e=0),z.$92l||(z.$92l=xb.e),xb.e=z.$92l-ue,S.setPoint(jo,xb)}else if(z.$87l instanceof T){var $=z.$87l,jo=z.$88l,N=hn(c.getDataUI($),$.s("edge.points")),xb=N.get(jo),ue=F.y-xb.y;xb.e||(xb.e=0),z.$92l||(z.$92l=xb.e),xb.e=z.$92l-ue,N.set(jo,xb),$.s("edge.points",ds(N))}}else if(8===z.$67l){var hp=c.sm().getSelection(),zr=z.$93l;zr||(zr=z.$93l={}),hp.each(function(i){if(i.p3){var h=i.p3(),r=zr[i.getId()];r==n&&(r=zr[i.getId()]=h[1]),i.p3([h[0],r-(F.y-z.$90l.y/u),h[2]])}})}else if(9===z.$67l){var hp=c.sm().getSelection(),En=z.$94l;En||(En=z.$94l={}),hp.each(function(f){if(f.s3){var N=f.s3(),x=En[f.getId()];x==n&&(x=En[f.getId()]=N[1]);var Y=x-(F.y-z.$91l.y/u);0>Y&&(Y=.01),f.s3([N[0],Y,N[2]])}})}},$79l:function(z,_){var r=this,x=r.gv,Z=x.getZoom(),g=x.getEditHelperSize(),Y=z.x/Z,s=z.y/Z,o=g/Z,w=o/2;return M({x:Y-w,y:s-w,width:o,height:o},_)?!0:void 0},getHelperCursor:function(){return"crosshair"},_79I:function(I,E){for(var g=this,S=g.gv,m=S.getZoom(),b=S.getEditPointSize(),O=b/m,n=O/2,W=g.$46l(I),o=0;o<W.length;o++){var i,w,V=W[o],C=S.getDataUI(V);if(C&&C._55O){var z=C._55O;if(z._43O&&V instanceof T){if(i=V.s("edge.points"),i=hn(C,i),w=V.s("edge.segments"),w&&w.size()||(w=gm(i)),g.$42l(V,E,i._as,w,"edge"))return!0;if("points"===V.s("edge.type")&&g.$41l(V,E,i._as,w,"edge"))return}if(z._43O&&V instanceof s&&z.$15l&&z.$15l.length===V.getPoints().size()){if(i=z.$15l,w=V.getSegments(),w&&w.size()||(w=gm(i)),g.$42l(V,E,i,w,"shape"))return!0;if(g.$41l(V,E,i,w,"shape"))return}}}if(g.$16l){var i,N=g.$16l,H=N[3].x-N[7].x,_=N[3].y-N[7].y,h=P(H*H+_*_),l=N[1].x-N[5].x,f=N[1].y-N[5].y,Y=P(l*l+f*f),c={x:E.x*m,y:E.y*m};if(g._80I(c,0,N[0],"northwest",h,Y)||g._80I(c,1,N[1],"north",h,Y)||g._80I(c,2,N[2],"northeast",h,Y)||g._80I(c,7,N[7],"west",h,Y)||g._80I(c,3,N[3],"east",h,Y)||g._80I(c,6,N[6],"southwest",h,Y)||g._80I(c,5,N[5],"south",h,Y)||g._80I(c,4,N[4],"southeast",h,Y))return!0}if(g.$23l){var $=g.$23l,A=$.x/m,j=$.y/m;if(M({x:A-n,y:j-n,width:O,height:O},E))return g.$40l=1,g.$12l=g.getHelperCursor("rotation")||"crosshair",!0}return g.$68l&&g.$79l(g.$68l,E)?(g.$67l=1,g.$12l=g.getHelperCursor("host")||"crosshair",!0):g.$69l&&g.$79l(g.$69l,E)?(g.$67l=2,g.$12l=g.getHelperCursor("parent")||"crosshair",!0):g.$70l&&g.$79l(g.$70l,E)?(g.$67l=3,g.$12l=g.getHelperCursor("edge")||"crosshair",!0):g.$71l&&g.$79l(g.$71l,E)?(g.$67l=4,g.$12l=g.getHelperCursor("remove")||"crosshair",!0):g.$82l&&g.$79l(g.$82l,E)?(g.$67l=5,g.$12l=g.getHelperCursor("source")||"crosshair",!0):g.$83l&&g.$79l(g.$83l,E)?(g.$67l=6,g.$12l=g.getHelperCursor("target")||"crosshair",!0):g._pointElevationHelperPoint&&g.$79l(g._pointElevationHelperPoint,E)?(g.$67l=7,g.$12l=g.getHelperCursor("pointElevation")||"crosshair",!0):g.$90l&&g.$79l(g.$90l,E)?(g.$67l=8,g.$12l=g.getHelperCursor("elevation")||"crosshair",!0):g.$91l&&g.$79l(g.$91l,E)?(g.$67l=9,g.$12l=g.getHelperCursor("tall")||"crosshair",!0):!1},_80I:function(D,j,K,X,N,O){var J=this,G=J.gv,q=G.getEditPointSize(),Z=q/2,t=G.sm(),_=G.isDirectionEditable;if(_&&1===t.size()){var P=t.ld();if(_=_.bind(G),P instanceof k){if(!_(P,X))return!1;if("east"===X){if(_(P,"northeast")&&_(P,"southeast")&&2*q>=O)return!1}else if("west"===X){if(_(P,"northwest")&&_(P,"southwest")&&2*q>=O)return!1}else if("north"===X){if(_(P,"northwest")&&_(P,"northeast")&&2*q>=N)return!1}else if("south"===X&&_(P,"southwest")&&_(P,"southeast")&&2*q>=N)return!1}}else{if(2*q>=N&&("north"===X||"south"===X))return!1;if(2*q>=O&&("east"===X||"west"===X))return!1}if(M({x:K.x-Z,y:K.y-Z,width:q,height:q},D)){if(J.$10l!==X){var S=180*J.$7l/C,z="";S>=337.5||22.5>S?z="north":S>=22.5&&67.5>S?z="northeast":S>=67.5&&112.5>S?z="east":S>=112.5&&157.5>S?z="southeast":S>=157.5&&202.5>S?z="south":S>=202.5&&247.5>S?z="southwest":S>=247.5&&292.5>S?z="west":S>=292.5&&337.5>S&&(z="northwest");var m=Mf.indexOf(z),z=Mf[j-(1-m)+8];switch(z){case"northwest":J.$12l="nwse-resize";break;case"northeast":J.$12l="nesw-resize";break;case"southwest":J.$12l="nesw-resize";break;case"southeast":J.$12l="nwse-resize";break;case"north":J.$12l="ns-resize";break;case"east":J.$12l="ew-resize";break;case"south":J.$12l="ns-resize";break;case"west":J.$12l="ew-resize"}J.$10l=X}return!0}return!1},$42l:function(X,j,K,R,h){var z,q=this,b=q.gv,H=b.getEditPointSize(),w=H/b.getZoom(),U=-1,p={x:j.x,y:j.y,width:0,height:0},B=function(W){"shape"===h?q._shape=X:q._edge=X,q._removePointIndex=W},k=function(C){"shape"===h?q._shape=X:q._edge=X,q.$13l=C,q.$12l="crosshair"};for($(p,w/2),U=K.length-1,z=R.size()-1;z>=0;z--){var g=R.get(z);if(1===g||2===g)U-=1;else if(3===g){var Z=K[U-1];if(M(p,Z))return k(U-1),!0;U-=2}else if(4===g){var o=K[U-1],S=K[U-2];if(M(p,o))return k(U-1),!0;if(M(p,S))return k(U-2),!0;U-=3}}for(U=K.length-1,z=R.size()-1;z>=0;z--){var g=R.get(z),f=K[U];if(M(p,f))return B(U),k(U),!0;1===g||2===g?U-=1:3===g?U-=2:4===g&&(U-=3)}return!1},$41l:function(T,w,Y,E,n){var c=this,K=c.gv,G=-1,r=0,N={x:w.x,y:w.y,width:0,height:0},p=function(s,t){c._hoverSegmentIndex=t,c._lp=w,"shape"===n?c._shape=T:c._edge=T};for($(N,K.getSegmentHoverWidth()/2/K.getZoom()),T instanceof s&&T.isClosePath()&&E.indexOf(5)<0&&(E=new u(E._as),E.add(5));r<E.size();r++){var _=E.get(r);if(1===_){var J=Y[G],U=Y[G+1];if(J){var v=Eg(new _b(J.x,J.y),new _b(U.x,U.y),new _b(N.x,N.y),new _b(N.x+N.width,N.y+N.height));if(v.$62l===m&&v.points.length>0)return p(v,r),!0}G+=1}else if(2===_){var J=Y[G],U=Y[G+1],v=Eg(new _b(J.x,J.y),new _b(U.x,U.y),new _b(N.x,N.y),new _b(N.x+N.width,N.y+N.height));if(v.$62l===m&&v.points.length>0)return p(v,r),!0;G+=1}else if(3===_){var J=Y[G],x=Y[G+1],I=Y[G+2],v=jc(new _b(J.x,J.y),new _b(x.x,x.y),new _b(I.x,I.y),new _b(N.x,N.y),new _b(N.x+N.width,N.y+N.height));if(v.$62l===m)return p(v,r),!0;G+=2}else if(4===_){var J=Y[G],D=Y[G+1],F=Y[G+2],I=Y[G+3],v=Sk(new _b(J.x,J.y),new _b(D.x,D.y),new _b(F.x,F.y),new _b(I.x,I.y),new _b(N.x,N.y),new _b(N.x+N.width,N.y+N.height));if(v.$62l===m)return p(v,r),!0;G+=3}else if(5===_){var J=Y[G],U=Y[0];if(J){var v=Eg(new _b(J.x,J.y),new _b(U.x,U.y),new _b(N.x,N.y),new _b(N.x+N.width,N.y+N.height));if(v.$62l===m&&v.points.length>0)return p(v,r),!0}}}return!1},addShapePoint:function(x,H,G){var M=this,R=M.gv,S=R.dm();if(S.beginTransaction(),0===arguments.length&&(x=M._shape||M._edge,H=M._hoverSegmentIndex,G=M._lp),x instanceof s||x instanceof T){var P=se(x,R.getDataUI(x),H);if(!isNaN(H)&&G&&!isNaN(P)){var o=G;if(x instanceof s){var n=x.p(),A=x.getRotation(),W=x.toSegments();W&&W.size()||(W=gm(x.getPoints())),x.isClosePath()&&W.indexOf(5)<0&&(W=new u(W._as),W.add(5));var h=W.get(H),L="addPoint",l="removePointAt";if(2===h||1===h){var I={x:o.x,y:o.y};W.add(h,H),I=ns(n,I.x-n.x,I.y-n.y,-A),x[L](I,P+1)}else if(3===h){var Z=x.getPoints(),k=Z.get(P),q=Z.get(P+2),I={x:o.x,y:o.y};I=ns(n,I.x-n.x,I.y-n.y,-A);var N=Sf(k,I),v=Sf(I,q);W.removeAt(H),W.add(3,H),W.add(3,H),x.setPoint(P+1,I),x[L](v,P+2),x[L](N,P+1)}else if(4===h){var Z=x.getPoints(),k=Z.get(P),q=Z.get(P+3),I={x:o.x,y:o.y};I=ns(n,I.x-n.x,I.y-n.y,-A);var N=Od(k,I),v=gc(k,I),Q=Od(I,q),i=gc(I,q);W.removeAt(H),W.add(4,H),W.add(4,H),x[l](P+1),x[l](P+1),x[L](I,P+1),x[L](i,P+2),x[L](Q,P+2),x[L](v,P+1),x[L](N,P+1)}else if(5===h){var I={x:o.x,y:o.y};W.add(2,H),I=ns(n,I.x-n.x,I.y-n.y,-A),x[L](I,P+1)}x.isClosePath()&&W.remove(5),x.setSegments(W);var _=x.getWidth(),E=x.getHeight(),D=x.p().x-_/2,J=x.p().y-E/2;D-=n.x,J-=n.y;var C=El(x,{x:D,y:J,width:_,height:E},A,n);x.p(C.x,C.y)}else if(x instanceof T){if("points"!==x.s("edge.type"))return S.endTransaction(),void 0;var Z=x.s("edge.points");W=x.s("edge.segments"),Z=hn(R.getDataUI(x),Z),W&&W.size()||(W=gm(Z)),W=new u(W._as.slice(0)),Z=new u(Z._as.slice(0));var h=W.get(H);if(2===h||1===h){var I={x:o.x,y:o.y};W.add(h,H),Z.add(I,P+1)}else if(3===h){var k=Z.get(P),q=Z.get(P+2),I={x:o.x,y:o.y},N=Sf(k,I),v=Sf(I,q);W.removeAt(H),W.add(3,H),W.add(3,H),Z.set(P+1,I),Z.add(v,P+2),Z.add(N,P+1)}else if(4===h){var k=Z.get(P),q=Z.get(P+3),I={x:o.x,y:o.y},N=Od(k,I),v=gc(k,I),Q=Od(I,q),i=gc(I,q);W.removeAt(H),W.add(4,H),W.add(4,H),Z.removeAt(P+1),Z.removeAt(P+1),Z.add(I,P+1),Z.add(i,P+2),Z.add(Q,P+2),Z.add(v,P+1),Z.add(N,P+1)}x.s("edge.points",ds(Z)),x.s("edge.segments",W)}}}S.endTransaction()},removeShapePoint:function(h,k){var M=this,i="removeAt",Y=M.gv,j=Y.dm();if(j.beginTransaction(),0===arguments.length&&(h=M._shape||M._edge,k=M._removePointIndex),k>=0&&(h instanceof s||h instanceof T)){var W=Qe(h,M.gv.getDataUI(h),k),X=k;if(h instanceof s){var e=h.p(),J=h.toSegments();J&&J.size()||(J=gm(h.getPoints()));var V=J.get(W),E="removePointAt";if(1===V&&0===X)if(h.getPoints().size()>1){var R=J.get(W+1);J[i](W+1),3===R?h[E](X+1):4===R&&(h[E](X+2),h[E](X+1)),h[E](X)}else h.dm().remove(h);else 2===V||1===V?(J[i](W),h[E](X)):3===V?(J[i](W),h[E](X),h[E](X-1)):4===V&&(J[i](W),h[E](X),h[E](X-1),h[E](X-2));h.setSegments(J);var y=h.getWidth(),f=h.getHeight(),Z=h.p().x-y/2,l=h.p().y-f/2;Z-=e.x,l-=e.y;var q=El(h,{x:Z,y:l,width:y,height:f},h.getRotation(),e);h.p(q.x,q.y)}else if(h instanceof T){if("points"!==h.s("edge.type"))return j.endTransaction(),void 0;var S=h.s("edge.points");if(J=h.s("edge.segments"),S&&(S=hn(M.gv.getDataUI(h),S),J&&J.size()||(J=gm(S))),0===k||k===S.size()-1)return j.endTransaction(),void 0;J=new u(J._as.slice(0)),S=new u(S._as.slice(0));var V=J.get(W);2===V||1===V?(J[i](W),S[i](X)):3===V?(J[i](W),S[i](X),S[i](X-1)):4===V&&(J[i](W),S[i](X),S[i](X-1),S[i](X-2)),h.s("edge.segments",J),h.s("edge.points",ds(S))}}j.endTransaction()},changeShapeSegment:function(G,g,A){var B=this,o=B.gv,v=o.dm();if(v.beginTransaction(),1!==arguments.length||isNaN(G)||(A=G,G=B._shape||B._edge,g=B._hoverSegmentIndex),G instanceof s||G instanceof T){var X=se(G,B.gv.getDataUI(G),g);if(!isNaN(g)&&!isNaN(X))if(G instanceof s){var O=G.p(),D=G.toSegments();D&&D.size()||(D=gm(G.getPoints()));var k=D.get(g),V=G.toPoints();if(1===A||2===A)1===k||2===k?D.set(g,A):3===k?(D.set(g,A),V.removeAt(X+1)):4===k&&(D.set(g,A),V.removeAt(X+1),V.removeAt(X+1));else if(3===A){var n=function(){var y=V.get(X),E=V.get(X+1),P=Sf(y,E);D.set(g,3),V.add(P,X+1)};2===k||1===k?n():4===k&&(V.removeAt(X+1),V.removeAt(X+1),n())}else if(4===A){var j=function(){var d=V.get(X),n=V.get(X+1),B=Od(d,n),c=gc(d,n);D.set(g,4),V.add(B,X+1),V.add(c,X+2)};2===k||1===k?j():3===k&&(V.removeAt(X+1),j())}G.setSegments(D),G.setPoints(V);var W=G.getWidth(),m=G.getHeight(),J=G.p().x-W/2,a=G.p().y-m/2;J-=O.x,a-=O.y;var f=new El(G,{x:J,y:a,width:W,height:m},G.getRotation(),O);G.p(f.x,f.y)}else if(G instanceof T){if("points"!==G.s("edge.type"))return v.endTransaction(),void 0;var V=G.s("edge.points");D=G.s("edge.segments"),V&&(V=hn(B.gv.getDataUI(G),V),D&&D.size()||(D=gm(V))),D=new u(D._as.slice(0)),V=new u(V._as.slice(0));var k=D.get(g);if(1===A||2===A)1===k||2===k?D.set(g,A):3===k?(D.set(g,A),V.removeAt(X+1)):4===k&&(D.set(g,A),V.removeAt(X+1),V.removeAt(X+1));else if(3===A){var n=function(){var Z=V.get(X),a=V.get(X+1),l=Sf(Z,a);D.set(g,3),V.add(l,X+1)};2===k||1===k?n():4===k&&(V.removeAt(X+1),V.removeAt(X+1),n())}else if(4===A){var j=function(){var E=V.get(X),u=V.get(X+1),R=Od(E,u),C=gc(E,u);D.set(g,4),V.add(R,X+1),V.add(C,X+2)};2===k||1===k?j():3===k&&(V.removeAt(X+1),j())}G.s("edge.points",ds(V)),G.s("edge.segments",D)}}v.endTransaction()},getDefaultSegments:function(D){var l=this.gv,q=l.getDataUI(D);if(D instanceof T){var j=D.s("edge.points");return j=hn(q,j),gm(j)}if(D instanceof s){var j=D.getPoints(),i=D.getSegments();return i&&i.size()>0?i:gm(j)}},$43l:function(Y){var p=this;Y&&(p.$5l=1),p._68I=1,p._42()},_42:function(){var J=this;if(J._68I){delete J._68I;var F=J.gv,R=J.$5l,K=F.getZoom(),G=F.getEditPointSize(),g=G/2,m=new u,c=J._view,C=J._edge,D=J._shape,N=c.getContext("2d"),U=F.tx(),B=F.ty(),j=n,Q=F.getEditPointBackground(),b=F.getControlPointBackground(),E=F.getControlPointBorderColor(),L=F.getEditPointBorderColor(),M=F.getEditRectBorderColor(),W=F.getDirectionLineColor(),i=F.getSegmentHoverColor(),Z=F.getSnapPointBorderColor(),d=F.getJoinPointBackground(),h=F.getJoinPointBorderColor(),f=F.getSegmentHoverWidth(),V=[5,5],l=F.getEditRectBorderStyle();tk(F,function(j){F.isSelected(j)&&F.isVisible(j)&&m.add(j)}),N.clearRect(0,0,q(c.width),q(c.height)),N.save(),o.translateAndScale(N,U,B,1);var r=n,O={x:0,y:0,width:0,height:0},Y=0,X=0,z=0,v=0,_=0,t=0,hh=0,mg=0,qp=0,fh=0,Jo=[];if(R?(delete J.$6l,delete J.$8l,delete J.$7l,delete J.$16l,delete J.$23l):(r=J.$6l,j=J.$7l),delete J.$68l,delete J.$69l,delete J.$71l,delete J.$70l,delete J.$82l,delete J.$83l,delete J._pointElevationHelperPoint,delete J.$90l,delete J.$91l,delete J.$75l,delete J.$74l,m.each(function(l){var I=F.getDataUI(l);if(I){var s=I._55O;if(F.isEditable(l))s._56O&&l instanceof k&&X++,Jo.push(l),s._42O&&l instanceof k&&Y++,F.isHelperEditable(l,"host")&&v++,F.isHelperEditable(l,"parent")&&z++,F.isHelperEditable(l,"remove")&&_++,F.isHelperEditable(l,"edge")&&t++,F.isHelperEditable(l,"source")&&hh++,F.isHelperEditable(l,"target")&&mg++,F.isHelperEditable(l,"elevation")&&qp++,F.isHelperEditable(l,"tall")&&fh++;else if(l instanceof A&&l.isExpanded()){var n=!0,M=F.getEditableFunc();M&&(n=M(l)),n&&(F.isHelperEditable(l,"host")&&v++,F.isHelperEditable(l,"parent")&&z++,F.isHelperEditable(l,"remove")&&_++,F.isHelperEditable(l,"edge")&&t++,F.isHelperEditable(l,"source")&&hh++,F.isHelperEditable(l,"target")&&mg++,F.isHelperEditable(l,"elevation")&&qp++,F.isHelperEditable(l,"tall")&&fh++,Jo.push(l))}}}),N.beginPath(),N.lineWidth=1,N.strokeStyle=F.getNodeBorderColor(),Jo.forEach(function(p){var s=F.getDataUI(p),D=s._55O;if(R)if(j==n&&(j=p instanceof T?0:p instanceof A&&p.isExpanded()?0:p.getRotation(),J.$7l=j),r==n){var V,d,P;if(p instanceof A&&p.isExpanded()||p instanceof T){var x=F.getDataUIBounds(p);d=x.width,P=x.height,V={x:x.x+d/2,y:x.y+P/2}}else V=p.p(),d=p.getWidth(),P=p.getHeight();r={x:V.x,y:V.y,width:0,height:0},O.x=V.x-d/2,O.y=V.y-P/2,O.width=d,O.height=P,r=e(r,O)}else{var V,d,P,h,z=r.x+r.width/2,W=r.y+r.height/2,u={x:z,y:W};if(p instanceof A&&p.isExpanded()||p instanceof T){h=0;var x=F.getDataUIBounds(p);d=x.width,P=x.height,V={x:x.x+d/2,y:x.y+P/2}}else V=p.p(),d=p.getWidth(),P=p.getHeight(),h=p.getRotation();var $={x:V.x-d/2,y:V.y-P/2,width:d,height:P},Q={x:$.x,y:$.y},M={x:$.x+$.width,y:$.y},_={x:$.x,y:$.y+$.height},E={x:$.x+$.width,y:$.y+$.height},Q=ns(V,Q.x-V.x,Q.y-V.y,h),_=ns(V,_.x-V.x,_.y-V.y,h),E=ns(V,E.x-V.x,E.y-V.y,h),M=ns(V,M.x-V.x,M.y-V.y,h),b=-j,v=ns(u,Q.x-u.x,Q.y-u.y,b),H=ns(u,M.x-u.x,M.y-u.y,b),G=ns(u,_.x-u.x,_.y-u.y,b),f=ns(u,E.x-u.x,E.y-u.y,b),w=y([v,H,G,f]);r=e(r,w),r.x-=z,r.y-=W;var B=El(n,r,j,u);r.x=B.x-r.width/2,r.y=B.y-r.height/2}if(Y>1&&F.isEditable(p)&&F.isRectEditable(p)&&p instanceof k){var I=p.getRect(),a=D.$45l,S=Ei(a[0],K),i=Ei(a[2],K),X=Ei(a[4],K),m=Ei(a[6],K);p.getRotation()?(N.moveTo(S.x,S.y),N.lineTo(i.x,i.y),N.lineTo(X.x,X.y),N.lineTo(m.x,m.y),N.lineTo(S.x,S.y)):N.rect(I.x*K,I.y*K,I.width*K,I.height*K)}}),N.stroke(),r){J.$6l=a(r),$(r,F.getEditRectPadding()/K);var jp={x:r.x+r.width/2,y:r.y+r.height/2},hq=Ir(jp,r.width,r.height,j),Tn=hq[0],Ui=hq[1],_l=hq[2],zq=hq[3],qs=hq[4],Ag=hq[5],vj=hq[6],Vq=hq[7];if(Tn=Ei(hq[0],K),Ui=Ei(hq[1],K),_l=Ei(hq[2],K),zq=Ei(hq[3],K),qs=Ei(hq[4],K),Ag=Ei(hq[5],K),vj=Ei(hq[6],K),Vq=Ei(hq[7],K),J.$8l=r,Y>0&&(J.$16l=[Tn,qs,Ui,Ag,zq,vj,_l,Vq],N.beginPath(),N.lineWidth=1,N.strokeStyle=M,"dashed"===l&&N.setLineDash&&N.setLineDash(V),N.moveTo(Tn.x,Tn.y),N.lineTo(Ui.x,Ui.y),N.lineTo(zq.x,zq.y),N.lineTo(_l.x,_l.y),N.lineTo(Tn.x,Tn.y),N.stroke(),"dashed"===l&&N.setLineDash&&N.setLineDash([])),N.beginPath(),N.lineWidth=1,N.fillStyle=Q,N.strokeStyle=L,Y>0){var Nr=Ag.x-Vq.x,cr=Ag.y-Vq.y,jf=P(Nr*Nr+cr*cr),$c=qs.x-vj.x,xs=qs.y-vj.y,Zh=P($c*$c+xs*xs),Li=2*G;if(F.isDirectionEditable&&1===Jo.length){var be=Jo[0],xq=F.getDataUI(be),bq=xq._55O,bp=F.isDirectionEditable.bind(F);if(bq._42O){var cf,ug,Fm,wg;bp(be,"northwest")&&(cf=!0,N.rect(Tn.x-g,Tn.y-g,G,G)),bp(be,"northeast")&&(ug=!0,N.rect(Ui.x-g,Ui.y-g,G,G)),bp(be,"southwest")&&(Fm=!0,N.rect(_l.x-g,_l.y-g,G,G)),bp(be,"southeast")&&(wg=!0,N.rect(zq.x-g,zq.y-g,G,G)),bp(be,"north")&&(cf&&ug?jf>Li&&N.rect(qs.x-g,qs.y-g,G,G):N.rect(qs.x-g,qs.y-g,G,G)),bp(be,"south")&&(wg&&Fm?jf>Li&&N.rect(vj.x-g,vj.y-g,G,G):N.rect(vj.x-g,vj.y-g,G,G)),bp(be,"west")&&(Fm&&cf?Zh>Li&&N.rect(Vq.x-g,Vq.y-g,G,G):N.rect(Vq.x-g,Vq.y-g,G,G)),bp(be,"east")&&(wg&&ug?Zh>Li&&N.rect(Ag.x-g,Ag.y-g,G,G):N.rect(Ag.x-g,Ag.y-g,G,G))}}else jf>Li&&(N.rect(qs.x-g,qs.y-g,G,G),N.rect(vj.x-g,vj.y-g,G,G)),Zh>Li&&(N.rect(Ag.x-g,Ag.y-g,G,G),N.rect(Vq.x-g,Vq.y-g,G,G)),N.rect(Tn.x-g,Tn.y-g,G,G),N.rect(Ui.x-g,Ui.y-g,G,G),N.rect(_l.x-g,_l.y-g,G,G),N.rect(zq.x-g,zq.y-g,G,G)}if(X>0){var es=J.$23l=ns(qs,0,2*-G,j);N.moveTo(es.x+g,es.y),N.arc(es.x,es.y,g,0,w,!1)}N.fill(),N.stroke(),J.$40l&&J.$44l(N,r,j);var pi,cn,_q=F.getLeftTopHelpers(),Tl=F.getRightTopHelpers(),Sg=F.getLeftBottomHelpers(),Je=F.getRightBottomHelpers(),br=F.getEdgeHelpers(),or=F.getEditHelperSize(),ep=or/2,Zo=function(c,S,m,M){"leftTop"===S?(pi=r.x*K-or-g-("h"===M?m*(or+g):0)-1,cn=r.y*K-or-g-("v"===M?m*(or+g):0)-1):"rightTop"===S?(pi=(r.x+r.width)*K+g+("h"===M?m*(or+g):0)+1,cn=r.y*K-or-g-("v"===M?m*(or+g):0)-1):"leftBottom"===S?(pi=r.x*K-or-g-("h"===M?m*(or+g):0)-1,cn=(r.y+r.height)*K+g+("v"===M?m*(or+g):0)+1):"rightBottom"===S&&(pi=(r.x+r.width)*K+g+("h"===M?m*(or+g):0)+1,cn=(r.y+r.height)*K+g+("v"===M?m*(or+g):0)+1);var a=pi+ep,G=cn+ep,w=(r.x+r.width/2)*K,E=(r.y+r.height/2)*K,Z=ns({x:w,y:E},a-w,G-E,j);if("host"===c){if(v>0)return J.$77l(N,j,Z),!0}else if("edge"===c){if(t>0)return J.$80l(N,j,Z),!0}else if("remove"===c){if(_>0)return Jo&&1===Jo.length&&Jo[0]instanceof T?J.$81l(N,j,{x:w+or/2+5,y:E}):J.$81l(N,j,Z),!0}else if("parent"===c){if(z>0)return Jo&&1===Jo.length&&Jo[0]instanceof T?J.$76l(N,j,{x:w-or/2-5,y:E}):J.$76l(N,j,Z),!0}else if("elevation"===c){if(qp>0)return J.$85l(N,j,Z),!0}else if("tall"===c){if(fh>0)return J.$86l(N,j,Z),!0}else if("source"===c||"target"===c){var $=Jo[0],R=F.getDataUI($),P=rp(R,!0),x=P[0],y=P[1];if(hh&&"source"===c)return J.$84l(N,r,x,!0,$.isLooped(),S,m,M),!0;if(mg&&"target"===c)return J.$84l(N,r,y,!1,$.isLooped(),S,m,M),!0}};if(_q&&_q.length>0){var Bs=0;_q.forEach(function(A){Zo(A,"leftTop",Bs,F.getLeftTopHelpersAlign()||"h")&&Bs++})}if(Tl&&Tl.length>0){var Bs=0;Tl.forEach(function(i){Zo(i,"rightTop",Bs,F.getRightTopHelpersAlign()||"h")&&Bs++})}if(Sg&&Sg.length>0){var Bs=0;Sg.forEach(function(g){Zo(g,"leftBottom",Bs,F.getLeftBottomHelpersAlign()||"h")&&Bs++})}if(Je&&Je.length>0){var Bs=0;Je.forEach(function(d){Zo(d,"rightBottom",Bs,F.getRightBottomHelpersAlign()||"h")&&Bs++})}if(br&&br.length>0&&((hh||mg)&&Jo&&1===Jo.length&&Jo[0]instanceof T?!0:!1)){var Bs=0;br.forEach(function(A){Zo(A,"edge",Bs,"h")&&Bs++})}if(J.$72l){var Bo,je=J.$67l,Qn=J.$68l,Ae=J.$69l,cs=(J.$71l,J.$70l),bl=J.$82l,Dn=J.$83l;if(1===je?Bo=Qn:2===je?Bo=Ae:3===je?Bo=cs:5===je?Bo=bl:6===je&&(Bo=Dn),Bo){var pp=F.lp(J.$72l),ce=F.getDataAt(J.$72l);if(ce&&ce instanceof k){var fr,ks,lo;if(J.$73l=ce,1===je)if(ce instanceof S.Grid)fr=J.$75l=An(ce,pp);else if(ce instanceof S.Shape){lo=J.$74l=xp(ce,pp);var Vd=ce.getPoints();if(lo){var Pm=lo.attachIndex,ib=se(ce,F.getDataUI(ce),Pm)+1,Qc=ib+1>=Vd.size()?0:ib+1,Mp=Vd.get(ib),Qg=Vd.get(Qc),zr=ce.p(),rk=ce.getRotation();Mp=ns(zr,Mp.x-zr.x,Mp.y-zr.y,rk),Qg=ns(zr,Qg.x-zr.x,Qg.y-zr.y,rk),N.beginPath(),N.strokeStyle=i,N.lineWidth=f,N.moveTo(Mp.x*K,Mp.y*K),N.lineTo(Qg.x*K,Qg.y*K),N.stroke()}}fr?ks=fr.rect:(ks=H.clone(F.getDataUIBounds(ce)),H.grow(ks,2)),N.beginPath(),N.rect(ks.x*K,ks.y*K,ks.width*K,ks.height*K),N.strokeStyle=1===je||4===je||6===je?x:p,N.lineWidth=2,N.setLineDash&&N.setLineDash([8,8]),N.stroke()}else delete J.$73l;pp.x=pp.x*K,pp.y=pp.y*K;var po=xi(Bo.x,Bo.y,pp.x,pp.y),Ph=ns(Bo,pp.x-Bo.x,pp.y-Bo.y,-po),Jk=Ph.x-Bo.x;N.save(),N.translate(Bo.x,Bo.y),N.rotate(po),I.width=Jk,I.height=40;var fe=p;(1===je||4===je||6===je)&&(fe=x),I.comps[0].gradientColor=fe,H.drawImage(N,I,0,-20,Jk,40),N.restore()}}}if(m.each(function(I){var X=F.getDataUI(I);if(X){var S,A,L=X._55O,H=X._78o;if(L&&L._43O&&I instanceof s?(S=L.$15l,A=I.getSegments(),A&&A.size()||(A=gm(S)),I.isClosePath()&&A.indexOf(5)<0&&(A=new u(A._as),A.add(5))):L&&H&&L._43O&&(S=I.s("edge.points"),A=I.s("edge.segments"),S=hn(X,S),A&&A.size()||(A=gm(S)),S&&(S=S._as)),S&&A){var v=0,O=A.size(),B=J._hoverSegmentIndex;S=S.slice(0);for(var e=0;e<S.length;e++)S[e]=Ei(S[e],K);N.beginPath(),N.strokeStyle=W,N.lineWidth=1,v=0;for(var e=0;O>e;e++){var G=A.get(e);if(1===G||2===G)v++;else if(3===G){var r=S[v-1],U=S[v],j=S[v+1];N.moveTo(r.x,r.y),N.lineTo(U.x,U.y),N.lineTo(j.x,j.y),v+=2}else if(4===G){var r=S[v-1],c=S[v],q=S[v+1],j=S[v+2];N.moveTo(r.x,r.y),N.lineTo(c.x,c.y),N.moveTo(q.x,q.y),N.lineTo(j.x,j.y),v+=3}}if(N.stroke(),D===I||C===I&&"points"===C.s("edge.type")){N.beginPath(),v=0,N.strokeStyle=i,N.lineWidth=f;for(var e=0;O>e;e++){var G=A.get(e);if(1===G||2===G){if(B===e){var r=S[v-1],j=S[v];N.moveTo(r.x,r.y),N.lineTo(j.x,j.y);break}v++}else if(3===G){if(B===e){var r=S[v-1],U=S[v],j=S[v+1];N.moveTo(r.x,r.y),N.quadraticCurveTo(U.x,U.y,j.x,j.y);break}v+=2}else if(4===G){if(B===e){var r=S[v-1],c=S[v],q=S[v+1],j=S[v+2];N.moveTo(r.x,r.y),N.bezierCurveTo(c.x,c.y,q.x,q.y,j.x,j.y);break}v+=3}else if(5===G&&B===e){var r=S[v-1],j=S[0];N.moveTo(r.x,r.y),N.lineTo(j.x,j.y);break}}N.stroke()}N.beginPath(),v=0,N.strokeStyle=h,N.lineWidth=1,N.fillStyle=d;for(var e=0;O>e;e++){var G=A.get(e);if(1===G||2===G){var j=S[v];N.moveTo(j.x+g,j.y),N.arc(j.x,j.y,g,0,w,!0),v++}else if(3===G){var j=S[v+1];N.moveTo(j.x+g,j.y),N.arc(j.x,j.y,g,0,w,!0),v+=2}else if(4===G){var j=S[v+2];N.moveTo(j.x+g,j.y),N.arc(j.x,j.y,g,0,w,!0),v+=3}}N.fill(),N.stroke(),N.beginPath(),v=0,N.strokeStyle=E,N.lineWidth=1,N.fillStyle=b;for(var e=0;O>e;e++){var G=A.get(e);if(1===G||2===G)v++;else if(3===G){var U=S[v];N.moveTo(U.x+g,U.y),N.arc(U.x,U.y,g,0,w,!0),v+=2}else if(4===G){var c=S[v],q=S[v+1];N.moveTo(c.x+g,c.y),N.arc(c.x,c.y,g,0,w,!0),N.moveTo(q.x+g,q.y),N.arc(q.x,q.y,g,0,w,!0),v+=3}}if(N.fill(),N.stroke(),N.beginPath(),v=0,N.strokeStyle=Z,N.lineWidth=2,(D===I||C===I)&&J.$9l!=n){var j=S[J.$9l];N.moveTo(j.x+g,j.y),N.arc(j.x,j.y,g,0,w,!0),N.stroke()}}}}),J.$87l&&F.sm().contains(J.$87l)){var Ih,Sj=J.$87l,Eb=J.$88l,or=F.getEditHelperSize(),ep=or/2;if(F.isHelperEditable(Sj,"pointElevation"))if(Sj instanceof s){var hf=Sj.getPosition();Ih=H.clone(Sj.getPoints().get(Eb)),Ih=ns({x:hf.x,y:hf.y},Ih.x-hf.x,Ih.y-hf.y,Sj.getRotation()),Ih.x*=K,Ih.y*=K,N.translate(Ih.x,Ih.y),H.drawImage(N,H.getImage("xeditinteractor_elevationIcon"),ep,-ep,or,or),N.translate(-Ih.x,-Ih.y),J._pointElevationHelperPoint={x:Ih.x+or,y:Ih.y}}else if(Sj instanceof T){var Tc=hn(F.getDataUI(Sj),Sj.s("edge.points")),Ih=H.clone(Tc.get(Eb));Ih.x*=K,Ih.y*=K,N.translate(Ih.x,Ih.y),H.drawImage(N,H.getImage("xeditinteractor_elevationIcon"),ep,-ep,or,or),N.translate(-Ih.x,-Ih.y),J._pointElevationHelperPoint={x:Ih.x+or,y:Ih.y}}}N.restore(),J.$5l=0}},$89l:function(B,W,D,X){B.save();var q=this,_=q.gv,v=_.getEditHelperSize(),f=v/2;B.beginPath(),B.translate(D.x,D.y),B.rotate(W),H.drawImage(B,X,-f,-f,v,v),B.restore()},$85l:function(R,u,X){var U=this;U.$90l=X,U.$89l(R,u,X,H.getImage("xeditinteractor_elevationIcon"))},$86l:function(I,u,V){var w=this;w.$91l=V,w.$89l(I,u,V,H.getImage("xeditinteractor_tallIcon"))},$77l:function(P,M,f){var S=this;S.$68l=f,S.$89l(P,M,f,H.getImage("xeditinteractor_hostIcon"))},$80l:function(P,J,N){var S=this;S.$70l=N,S.$89l(P,J,N,H.getImage("xeditinteractor_edgeIcon"))},$81l:function(F,w,s){var E=this;E.$71l=s,E.$89l(F,w,s,H.getImage("xeditinteractor_removeIcon"))},$76l:function(A,Y,a){var k=this;k.$69l=a,k.$89l(A,Y,a,H.getImage("xeditinteractor_parentIcon"))},$84l:function(L,E,q,N,b){var C,Y=this,k=Y.gv,z=k.getZoom(),i=k.getEditHelperSize(),p=i/2;q.x*=z,q.y*=z,b&&(N?q.x-=p+5:q.x+=p+5),q.y-=i-2,N?(Y.$82l=q,C=H.getImage("xeditinteractor_sourceIcon")):(Y.$83l=q,C=H.getImage("xeditinteractor_targetIcon")),L.beginPath(),L.translate(q.x,q.y),H.drawImage(L,C,-p,-p,i,i),L.translate(-q.x,-q.y)},$44l:function(S,X,d){S.save();var k=this.gv.getZoom(),I=P(z(X.width,2)+z(X.height,2))/2*k+10,Z=I,E=Z+8,y=Z+18,H=d,f=X.x+X.width/2,V=X.y+X.height/2;S.translate(f*k,V*k),S.beginPath(),S.strokeStyle="rgb(150, 150, 150)";for(var M=0,F=0,A=0,U=0,h=0,Y=0;360>Y;Y++)M=Y*C/180,0===Y%5&&(F=G(M)*Z,A=l(M)*Z,U=G(M)*E,h=l(M)*E,S.moveTo(F,A),S.lineTo(U,h)),0===Y%45&&(F=G(M)*Z,A=l(M)*Z,U=G(M)*y,h=l(M)*y,S.moveTo(F,A),S.lineTo(U,h));S.stroke(),S.beginPath(),S.rotate(-j),S.beginPath(),S.fillStyle="rgba(255, 0, 0, 0.1)",S.strokeStyle="rgb(157, 157, 157)",S.moveTo(0,0),S.arc(0,0,y,0,d,!1),S.fill(),S.beginPath(),S.moveTo(0+y,0),S.arc(0,0,y,0,d,!1),S.stroke(),S.rotate(j),S.font="bold 12px Verdana, Arial";var $=20*l(H),a=20*G(H),J=r(180*H/C)+"";S.textAlign="center",S.textBaseline="middle",S.beginPath();var g=S.measureText("365.").width;S.fillStyle="white",S.rect($-g/2,-a-10,g,20),S.fill(),S.beginPath(),S.fillStyle="rgb(79,79,79)",S.fillText(J,$,-a),S.restore()}})}("undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:(0,eval)("this"),Object);