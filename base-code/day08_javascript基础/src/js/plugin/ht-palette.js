!function(E,x,G){"use strict";var q="px",X="0",e="innerHTML",W="className",U=ht.Default,f=ht.Color,L=ht.Node,w="position",y="top",p="left",D=U.animate,C=U.getInternal(),P="width",X="0",m="none",k="max-height",$="font",c="background",I="border-box",F="user-select",n="box-sizing",A="overflow",v=U.isTouchable,C=U.getInternal(),_=f.titleIconBackground,g=U.scrollBarInteractiveSize,Q=/msie 9/.test(E.navigator?E.navigator.userAgent.toLowerCase():""),i=null,z=function(){return document},R=function(c){return z().createElement(c)},T=function(){return R("div")},O=function(){var c=T(),O=c.style;return O.msTouchAction=m,O.cursor="default",v&&O.setProperty("-webkit-tap-highlight-color","rgba(0, 0, 0, 0)",i),O.position="absolute",O.left=X,O.top=X,c},r=function(){return R("canvas")},u=function(){return document.body},K=function(l,b,J){l.style.setProperty(b,J,i)},N=function(l,g){l.style.removeProperty(g)},Y=function(G,Q,n){U.def(ht.widget[G],Q,n)},H=function(O,A){O.appendChild(A)},d=function(R,p){R.removeChild(p)},M=U.eventListenerOptionsFalse,B=(U.eventListenerOptionsTrue,function(h,v,b,E){h.addEventListener(v,b,E?M:M)});C.addMethod(U,{paletteExpandIcon:{width:16,height:16,comps:[{type:"triangle",rect:[4,4,10,8],background:_,rotation:3.14}]},paletteCollapseIcon:{width:16,height:16,comps:[{type:"triangle",rect:[4,4,10,8],background:_}]},paletteTitleLabelColor:U.labelSelectColor,paletteTitleLabelFont:U.labelFont,paletteContentLabelFont:U.labelFont,paletteContentLabelColor:"#777",paletteContentBackground:"#fff",paletteTitleHeight:U.widgetTitleHeight,paletteTitleBackground:f.titleBackground,paletteTitleHoverBackground:f.titleBackground,paletteSeparatorWidth:1,paletteSeparatorColor:G,paletteItemHoverBorderColor:f.highlight,paletteItemSelectBackground:f.highlight},!0);var J=".palette-item:hover{border: 1px solid "+U.paletteItemHoverBorderColor+" !important}"+" .palette-header:hover{background: "+U.paletteTitleHoverBackground+" !important}",Z=document.createElement("style");v||(Z.styleSheet?Z.styleSheet.cssText=J:Z.appendChild(z().createTextNode(J))),z().getElementsByTagName("head")[0].appendChild(Z);var S=function(k){var M=this;M.$22h=k,M.addListeners()};U.def(S,x,{ms_listener:1,getView:function(){return this.$22h.getView()},$26h:function(){var k=this;k.$36h&&u().removeChild(k.$36h),k.$23h=k.$24h=k.$25h=k.$35h=k.$36h=i},handle_touchstart:function(t){for(var Z,d=this,a=d.$22h,R=t.target,u=a.sm(),y=a.dm(),X="palette-header",q="palette-header-tool",$="palette-item",l=!1,F=!1,f=!1;R&&(R[W]||"").indexOf(X)<0&&(R[W]||"").indexOf($)<0;)R=R.parentNode;if(R&&R[W].indexOf(q)>=0?l=!0:R&&R[W].indexOf(X)>=0?f=!0:R&&R[W].indexOf($)>=0&&(F=!0),U.isLeftButton(t))if(d.$27h(t))d.$24h=U.getClientPoint(t),d.$25h=a.ty();else if(l){U.preventDefault(t),Z=R.parentNode.$11h;var o=y.getDataById(Z),x=o.s("tools")[R.toolIndex];x.action&&x.action.call(a)}else if(f){U.preventDefault(t),Z=R.$11h;var o=y.getDataById(Z);o.isExpanded()?o.setExpanded(!1):o.setExpanded(!0)}else if(F){Z=R.$11h;var V=y.getDataById(Z);u.ss(V),a.handleDragAndDrop&&(U.preventDefault(t),V.s("draggable")&&(a.handleDragAndDrop(t,"prepare"),d.$35h=0)),V.s("draggable")||(U.preventDefault(t),d.$24h=U.getClientPoint(t),d.$25h=a.ty())}else U.preventDefault(t),d.$24h=U.getClientPoint(t),d.$25h=a.ty();else d.$26h(t)},handle_mousedown:function(w){this.handle_touchstart(w)},handle_mousewheel:function(P){this.handleScroll(P,P.wheelDelta/40,P.wheelDelta!==P.wheelDeltaX)},handle_DOMMouseScroll:function(m){this.handleScroll(m,-m.detail,1)},handleScroll:function(m,l,x){var C=this.$22h;U.preventDefault(m),x&&C._41o()&&C.ty(C.ty()+20*l)},handle_mouseup:function(V){this.handle_touchend(V)},handle_touchend:function(f){var O=this;O.$37h(f),O.$26h(f)},handleWindowMouseUp:function(m){this.handleWindowTouchEnd(m)},handleWindowTouchEnd:function(N){var V=this;V.$37h(N),V.$26h(N)},$37h:function(K){var e=this,v=e.$22h;2===e.$35h&&(e.$35h=3,v.handleDragAndDrop(K,"end"))},handleWindowMouseMove:function(q){this.handleWindowTouchMove(q)},handleWindowTouchMove:function(X){var N=this,C=N.$22h,R=N.$23h,_=N.$24h,r=N.$25h,p=U.getClientPoint(X),D=C._29I,V=N.$36h;if(1===N.$35h||2===N.$35h){if(N.$35h=2,C.handleDragAndDrop(X,"between"),v){var f=X.touches[0];X=f?f:X.changedTouches[0]}V.style.left=X.pageX-parseInt(V.width)/2+q,V.style.top=X.pageY-parseInt(V.height)/2+q}else"p"===R?C.ty(r+p.y-_.y):"v"===R&&C.ty(r+(_.y-p.y)/D.height*C._59I)},handle_mousemove:function(V){this.handle_touchmove(V)},handle_touchmove:function(n){if(!U.isDragging()&&U.isLeftButton(n)){var k=this,E=k.$22h,i=k.$27h(n);if(k.$24h){if(!k.$23h){if(U.getDistance(U.getClientPoint(n),k.$24h)<2)return;k.$23h=i?"v":"p",U.startDragging(k)}}else if(i)E._43o();else if(0===k.$35h){if(k.$35h=1,E.handleDragAndDrop(n,"begin"),v){var I=n.touches[0];n=I?I:n.changedTouches[0]}var d=k.$36h=new Image,p=E.$10h[E.sm().ld().getId()].querySelector(".image-box"),M=parseInt(p.style.width),j=parseInt(p.style.height);d.draggable=!1,d.src=p.toDataURL(),d.width=M,d.height=j,d.style.position="absolute",d.style.left=n.pageX-M/2+q,d.style.top=n.pageY-j/2+q,u().appendChild(d),U.startDragging(k)}}},$27h:function(M){var v=this.$22h,b=v.getView(),$=b.getBoundingClientRect(),A=v._29I,D=M.clientX-$.left+b.scrollLeft;return v._41o()&&A.x+A.width-D<g}}),ht.widget.Palette=function(R){var D=this,Q=D._view=C.createView(null,D);D.$9h={},D.$10h={},D.$4h={},D._29I={x:0,y:0,width:0,height:0},D._59I=0,D.dm(R?R:new ht.DataModel),Q[W]="ht-widget-palette",D.$29h=new S(D),K(Q,c,U.paletteContentBackground),K(Q,A,"auto"),K(Q,n,I),K(Q,"-moz-"+n,I),K(Q,"-webkit-"+F,m),K(Q,"-moz-"+F,m),K(Q,"-ms-"+F,m),K(Q,F,m),K(Q,"position","absolute"),K(Q,"overflow","hidden"),H(Q,D._79O=O()),B(Q,"dragstart",function(O){O.dataTransfer&&(O.dataTransfer.setData("Text","nodeid:"+O.target.$11h),O.dataTransfer.effectAllowed="all",D.$29h.$26h())})},Y("Palette",x,{ms_v:1,ms_fire:1,ms_dm:1,ms_sm:1,ms_vs:1,ms_ac:["itemImageWidth","itemImageHeight","itemImagePadding","itemMargin","layout","autoHideScrollBar","scrollBarSize","scrollBarColor"],$30h:0,_itemImagePadding:4,_itemImageWidth:70,_itemImageHeight:50,_itemMargin:10,_layout:"largeicons",_autoHideScrollBar:U.autoHideScrollBar,_scrollBarSize:U.scrollBarSize,_scrollBarColor:U.scrollBarColor,getViewRect:function(){return this._29I},ty:function(p){return p==i?this.getTranslateY():(this.setTranslateY(p),void 0)},setTranslateY:function(f){if(this.$32h==i){var X=this,q=X.$33h(f),d=X.$30h;X.$30h=q,X.fp("translateY",d,q)}},getTranslateY:function(){return this.$30h},setLayout:function(C){var X,q,U=this,D=U._layout;U._layout=C,"smallicons"===C?X=q=20:"iconsonly"===C?X=q=50:(X=70,q=50),U.setItemImageWidth(X),U.setItemImageHeight(q),U.setItemImagePadding(4),U.fp("layout",D,C)},getDataAt:function(D){for(var T=D.target;T&&T.$11h==i;)T=T.parentNode;return T&&T.$11h!=i?this.getDataModel().getDataById(T.$11h):void 0},$20h:function(){var B=16;return v&&(B*=1.2),B},$19h:function(){return U.paletteTitleHeight},$18h:function(){var s=U.paletteSeparatorWidth,b=U.paletteTitleBackground,L=U.paletteSeparatorColor||U.brighter(b);return s+q+" solid "+L},$17h:function(t){K(t,"cursor","pointer"),K(t,"display","inline-block"),K(t,"margin-right",(v?8:4)+q),K(t,"vertical-align",y)},$1h:function(B){var m=this,Z=T(),Q=T(),V=R("span");Z[W]="palette-header",K(Z,w,"relative"),K(Z,c,U.paletteTitleBackground),K(Z,"color",U.paletteTitleLabelColor),K(Z,y,X),K(Z,n,I),K(Z,"-moz-"+n,I),K(Z,"padding","0 5px 0 0"),K(Z,"border-top",m.$18h()),K(Z,P,"100%"),K(Z,"cursor","pointer"),K(Z,"white-space","nowrap"),K(Z,A,"hidden"),K(Z,$,U.paletteTitleLabelFont),K(Z,"line-height",m.$19h()+q),Z.$11h=B.getId();var d=r(),l=m.$19h(),s=m.$20h();m.$17h(d),C.setCanvas(d,s,l),H(Z,d);var k=B.s("tools");if(k)for(var L=0;L<k.length;L++){var E=r();m.$17h(E),C.setCanvas(E,s,l),E[W]="palette-header-tool palette-header-tool"+B.getId()+"-"+L,E.style.position="absolute",E.style.right=(s+10)*L+"px",E.toolIndex=L,H(Z,E)}return d[W]="palette-toggle-icon-"+B.getId(),Q[W]="palette-content",K(Q,"max-height",0+q),K(Q,$,U.paletteContentLabelFont),K(Q,A,"hidden"),Q.$11h=B.getId(),m.$9h[B.getId()]=Q,V[e]=B.getName(),K(V,$,U.paletteTitleLabelFont),H(Z,d),H(Z,V),[Z,Q]},$2h:function(P){var s=this,D=s._layout,b=Q&&P.s("draggable")?R("a"):T(),I=r(),Z=T(),M=P.getName()||"",c=P.s("title")||P.getToolTip()||M,$=s._itemMargin;I[W]="image-box";var G=s.getItemImageWidth(),x=s.getItemImageHeight();return C.setCanvas(I,G,x),H(b,I),Z[e]=M,Z[W]="label-box","iconsonly"!==D&&H(b,Z),b[W]="palette-item",K(b,"vertical-align",y),K(b,"cursor","pointer"),K(b,"border-radius",5+q),K(b,"border","1px solid transparent"),K(b,"text-align","center"),K(b,"display","inline-block"),K(b,"margin-left",$+q),K(b,"margin-top",$+q),K(b,"color",U.paletteContentLabelColor),"smallicons"===D?(K(I,"vertical-align","middle"),K(b,"margin-left",2+q),K(b,"margin-top",2+q),K(b,"padding",2+q),K(b,"text-align",p),K(Z,"display","inline-block"),K(Z,"min-width",s.$21h+s._itemMargin+q)):"largeicons"===D&&(K(Z,"max-width",G+q),K(Z,"overflow","hidden")),b.$11h=P.getId(),c&&(b.title=c),P.s("draggable")&&!s.handleDragAndDrop&&(Q?(b.href="#",K(b,"text-decoration",m)):b.draggable="true"),b},$16h:function(J,O,D,F){var f=C.initContext(J);C.translateAndScale(f,0,0,1),f.clearRect(0,0,D,D);var j=(D-F)/2;U.drawStretchImage(f,U.getImage(O),"fill",0,j,F,F),f.restore()},$15h:function(G){var y=this,s=G.getId(),r=y._view.querySelector(".palette-toggle-icon-"+s),N=G.isExpanded()?U.paletteCollapseIcon:U.paletteExpandIcon;if(r&&N){var R=y.$19h(),q=y.$20h();y.$16h(r,N,R,q)}},_drawToolsIcon:function(h){var Q=this,p=h.s("tools");if(p)for(var s=0;s<p.length;s++){var O=Q._view.querySelector(".palette-header-tool"+h.getId()+"-"+s),A=p[s].icon,W=Q.$19h(),r=Q.$20h();Q.$16h(O,A,W,r)}},$14h:function(o){var j=this,r=o.getId(),T=j.$10h[r].querySelector(".image-box"),J=o.getImage(),_=o.s("image.stretch");if(T&&J){var i=C.initContext(T),Q=j.getItemImagePadding();Q="smallicons"===j._layout?Q/2:Q;var u=j.getItemImageWidth()-2*Q,B=j.getItemImageHeight()-2*Q;C.translateAndScale(i,0,0,1),i.clearRect(0,0,u,B),U.drawStretchImage(i,U.getImage(J),_,Q,Q,u,B,o,j),i.restore()}},validateImpl:function(){var y,x,J,Q=this,S=Q.$9h,g=Q._layout,m=Q.$10h,v=Q.$4h,A=Q._view,a=Q.dm();if(Q.$13h&&(delete Q.$13h,v={},a.each(function(E){v[E.getId()]=E})),"smallicons"===g)for(var K in v){var j=v[K];if(j instanceof L){var w=j.getName()||"",l=U.getTextSize(U.paletteContentLabelFont,w).width;Q.$21h!=i&&Q.$21h>l||(Q.$21h=l)}}for(var K in v){J=v[K];var V,Y;if(a.contains(J)){if(J instanceof ht.Group){var C,b=Q.$1h(J),W=m[J.getId()];W&&(C=W.nextSibling,d(A,C),d(A,W)),x=a.getSiblings(J).indexOf(J);var E=A.children[2*x]||Q._79O;E&&E.parentNode?(A.insertBefore(b[0],E),A.insertBefore(C||b[1],E)):(A.appendChild(b[0]),A.appendChild(C||b[1])),m[J.getId()]=b[0],y=S[J.getId()]=C||b[1],Y=J.$12h;var $=J.s("promptText");Y||(J.$12h=R("div"),J.$12h[e]=$||"",Y=J.$12h),0===J.getChildren().size()?y.contains(Y)||H(y,Y):y.contains(Y)&&d(y,Y)}else if(V=J.getParent()){var o=Q.$2h(J),I=m[J.getId()];y=S[V.getId()],I&&d(I.parentNode,I),x=a.getSiblings(J).indexOf(J);var f=y.children[x];f?y.insertBefore(o,f):H(y,o),m[J.getId()]=o,Q.$14h(J)}}else{var T=m[J.getId()],c=T.parentNode;if(J instanceof ht.Group){var M=T.nextSibling;d(A,T),d(A,M),delete S[J.getId()]}else d(c,T),0===c.children.length&&(V=a.getDataById(c.$11h),V&&(Y=V.$12h,Y&&!c.contains(Y)&&H(c,Y)));delete m[J.getId()]}}Q.$4h={};var B=function(){var X=Q._59I,v=0;Q.$32h!=i&&(clearInterval(Q.$32h),v=0,delete Q.$32h),Q.$32h=setInterval(function(){Q.$31h(),X===Q._59I?(v++,v>=2&&(clearInterval(Q.$32h),delete Q.$32h)):(v=0,X=Q._59I)},30)};for(var G in S)if(y=S[G],J=a.getDataById(S[G].$11h),Q.$15h(J),Q._drawToolsIcon(J),J.isExpanded()){if(y.style.maxHeight===0+q){var P=y.scrollHeight+Q._itemMargin+q;D(y).duration(200).set(k,P).set("padding-bottom",Q._itemMargin+q).end(function(){return function(){B()}}(P))}else y.style.maxHeight=y.scrollHeight+q;y.style.paddingBottom=Q._itemMargin+q}else y.style.maxHeight!==0+q&&D(y).duration(200).set(k,X).set("padding-bottom",X).end(function(){return function(){B()}}(y));Q.$28h(),Q.$31h()},$31h:function(){for(var Z=this,u=Z._view,R=0,b=u.children,t=0;t<b.length;t++){var h=b[t];h.className&&h.className.indexOf("palette-")>=0&&(R+=h.offsetHeight)}Z._59I=R,Z.$30h=Z.$33h(Z.ty());var J=Z.ty();u.scrollTop=-J,Z._29I={x:0,y:-J,width:u.clientWidth,height:u.clientHeight},K(Z._79O,y,-J+q),Z._93I()},$33h:function(E){var f=this,q=f._29I.height-f._59I;return q>E&&(E=q),E>0?0:Math.round(E)},redraw:function(){this.$13h||(this.$13h=1,this.iv())},onPropertyChanged:function(z){["autoHideScrollBar","scrollBarSize","scrollBarColor","translateY"].indexOf(z.property)<0&&this.redraw(),"translateY"===z.property&&(this.iv(),this._43o())},findDataByName:function(U){for(var a=this.dm().getDatas(),V=0;V<a.size();V++){var D=a.get(V);if(D.getName()===U)return D}},setDataModel:function(L){var i=this,W=i._dataModel,Y=i._selectionModel;W!==L&&(W&&(W.umm(i.$6h,i),W.umd(i.$8h,i),W.umh(i.$7h,i),Y||W.sm().ums(i.$28h,i)),i._dataModel=L,L.mm(i.$6h,i),L.md(i.$8h,i),L.mh(i.$7h,i),Y?Y._21I(L):L.sm().ms(i.$28h,i),i.sm().setSelectionMode("single"),i.fp("dataModel",W,L))},$6h:function(h){var r=this,t=r._view,n=h.data,d=r.$4h;"add"===h.kind?d[n.getId()]=n:"remove"===h.kind?d[n.getId()]=n:"clear"===h.kind&&(r.$10h={},r.$9h={},r.$4h={},t[e]=""),r.iv()},$7h:function(y){var J=this,A=y.data;J.$4h[A.getId()]=A,J.iv()},$8h:function(l){var T=this,F=l.data,_=l.property;"expanded"===_?T.iv():(T.$4h[F.getId()]=F,T.iv())},$28h:function(){var j,h=this,G=h.sm(),a="palette-item",S=G.ld();this.dm().each(function(Y){j=h.$10h[Y.getId()],j&&j[W].indexOf(a)>=0&&(Y===S?K(j,c,U.paletteItemSelectBackground):N(j,c))})}})}("undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:(0,eval)("this"),Object);